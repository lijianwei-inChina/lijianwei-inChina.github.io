<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="钉钉的成绩上传很烦人，成绩要按照顺序一个一个输入。。。太麻烦了。所以要用科技改变生活。程序猿走起！">
<meta property="og:type" content="article">
<meta property="og:title" content="excel处理">
<meta property="og:url" content="http://yoursite.com/2020/11/07/excel%E5%A4%84%E7%90%86/index.html">
<meta property="og:site_name" content="李坚蔚 の Blog">
<meta property="og:description" content="钉钉的成绩上传很烦人，成绩要按照顺序一个一个输入。。。太麻烦了。所以要用科技改变生活。程序猿走起！">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-11-07T00:40:20.000Z">
<meta property="article:modified_time" content="2020-11-08T04:12:38.463Z">
<meta property="article:author" content="李坚蔚">
<meta property="article:tag" content="编程">
<meta property="article:tag" content="电脑工具">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2020/11/07/excel%E5%A4%84%E7%90%86/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>excel处理 | 李坚蔚 の Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">李坚蔚 の Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/11/07/excel%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李坚蔚">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李坚蔚 の Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          excel处理
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-11-07 08:40:20" itemprop="dateCreated datePublished" datetime="2020-11-07T08:40:20+08:00">2020-11-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-11-08 12:12:38" itemprop="dateModified" datetime="2020-11-08T12:12:38+08:00">2020-11-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>钉钉的成绩上传很烦人，成绩要按照顺序一个一个输入。。。<br>太麻烦了。<br>所以要用科技改变生活。<br>程序猿走起！<br><a id="more"></a></p>
<h1 id="钉钉excel成绩上传格式化工具"><a href="#钉钉excel成绩上传格式化工具" class="headerlink" title="钉钉excel成绩上传格式化工具"></a>钉钉excel成绩上传格式化工具</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">目前版本：Version 1.0-Beta</span><br><span class="line">开发环境：eclipse, JavaSE-12</span><br><span class="line">&#96;&#96;&#96;    </span><br><span class="line"></span><br><span class="line">## Version 1.0-Beta Date:2020.11.07 16:30</span><br><span class="line"></span><br><span class="line">### 准备工作</span><br><span class="line">java处理excel表格工具有很多，比如jxl.jar。</span><br><span class="line">从网上下载jxl.jar之后，在eclipse项目文件夹下新建一个lib文件夹（当然名字可以随意，但是我习惯于起名为lib），将jxl.jar放在lib文件夹内。</span><br><span class="line">回到eclipse，选中项目，右键，点击Reflash（按下F5即可），可以看到lib文件夹已经出现在eclipse中了。</span><br><span class="line">展开lib文件夹，选中jxl.jar，右键，选中Build Path-&gt;Configure Build Path，就可以看到出现了一个Referenced Libraries。这时，在项目中就可以使用jxl.jar中的方法了！</span><br><span class="line"></span><br><span class="line">但是，发现jxl.jar只能处理03年以前的文件。</span><br><span class="line"></span><br><span class="line">所以改成使用poi来实现这个功能。同样，下载后加载到Referenced Libraries。</span><br><span class="line"></span><br><span class="line">### 日志模块 Log.java</span><br></pre></td></tr></table></figure>
<p>package dingtalkExcel;</p>
<p>import java.io.File;<br>import java.io.FileWriter;<br>import java.io.IOException;<br>import java.io.PrintWriter;<br>import java.util.Date;</p>
<p>import javax.swing.JOptionPane;</p>
<p>public class Logger {<br>    private Logger() {</p>
<pre><code>&#125;

public final static File ERRORLOGFILE = new File(&quot;.\\Logger\\error.log&quot;);// 错误log日志文件默认保存地址
public final static File LOG = new File(&quot;.\\Logger\\ScoreFormat.log&quot;);// 操作log日志文件默认保存地址

/**
 * &lt;p&gt;
 * 这个方法用于提示用户异常信息 &lt;i&gt;Msg&lt;/i&gt; 并且储存到文件 &lt;i&gt;logfile&lt;/i&gt; 中。
 * &lt;/p&gt;
 * 
 * @param Msg       错误消息
 * @param errorfile 保存错误日志的文件
 * @param logfile   保存普通日志的文件
 */
public static void Error(String Msg, File errorfile, File logfile) &#123;

    if (!errorfile.getParentFile().exists()) &#123;
        errorfile.getParentFile().mkdirs();
    &#125;
    if (!errorfile.exists()) &#123;
        try &#123;
            errorfile.createNewFile();
        &#125; catch (IOException e) &#123;
            e.printStackTrace();
        &#125; // 如果文件没有创建，则创建之
    &#125;

    // 先显示人性化提示内容
    String m = new String(&quot;不好意思,出现了一个异常。&quot;);
    JOptionPane.showMessageDialog(null, m, &quot;错误提示&quot;, JOptionPane.PLAIN_MESSAGE, null);
    // 再显示异常的具体信息
    JOptionPane.showMessageDialog(null, Msg, &quot;错误提示&quot;, JOptionPane.PLAIN_MESSAGE, null);

    // 然后输出到error文件中
    FileWriter fw = null;
    try &#123;
        // 如果文件存在,则追加内容；如果文件不存在,则创建文件
        fw = new FileWriter(errorfile, true);
    &#125; catch (IOException e) &#123;
        e.printStackTrace();
    &#125;
    PrintWriter pw = new PrintWriter(fw);
    // log文件的内容设计
    String errStr = &quot;----[Time:&quot; + new Date().toString() + &quot;] Exception Caused----\n&quot; + Msg
            + &quot;\n--------------------------------------------------------------------------------&quot;;
    // 追加输出
    pw.println(errStr);
    pw.flush();
    pw.close();

    Log(errStr, logfile);// 继续输出到log文件

&#125;

/**
 * &lt;p&gt;
 * 这个方法用于提示用户异常信息 &lt;i&gt;Msg&lt;/i&gt; 并且储存到默认文件 &lt;i&gt;ERRORLOGFILE&lt;/i&gt; 中。
 * &lt;/p&gt;
 * 
 * @param Msg 错误消息
 */
public static void Error(String Msg) &#123;
    Error(Msg, ERRORLOGFILE, LOG);
&#125;

/**
 * &lt;p&gt;
 * 这个方法用于储存日志 &lt;i&gt;Msg&lt;/i&gt; 到默认文件 &lt;i&gt;LOG&lt;/i&gt; 中。
 * &lt;/p&gt;
 * 
 * @param Msg 日志信息
 */
public static void Log(String Msg) &#123;
    Log(Msg, LOG);
&#125;

/**
 * &lt;p&gt;
 * 这个方法用于储存日志 &lt;i&gt;Msg&lt;/i&gt; 到文件 &lt;i&gt;logfile&lt;/i&gt; 中。
 * &lt;/p&gt;
 * 
 * @param Msg     日志信息
 * @param logfile 保存的文件
 */
public static void Log(String Msg, File logfile) &#123;

    if (!logfile.getParentFile().exists()) &#123;
        logfile.getParentFile().mkdirs();
    &#125;
    if (!logfile.exists()) &#123;
        try &#123;
            logfile.createNewFile();
        &#125; catch (IOException e) &#123;
            e.printStackTrace();
        &#125; // 如果文件没有创建，则创建之
    &#125;
    // 输出log
    FileWriter fw = null;
    try &#123;
        // 如果文件存在,则追加内容；如果文件不存在,则创建文件
        fw = new FileWriter(logfile, true);
    &#125; catch (IOException e) &#123;
        e.printStackTrace();
    &#125;
    PrintWriter pw = new PrintWriter(fw);
    // log文件的内容设计
    String logStr = &quot;----[Time:&quot; + new Date().toString() + &quot;] Logger----\n&quot; + Msg
            + &quot;\n----------------------------------------------------------------------&quot;;
    // 追加输出
    pw.println(logStr);
    pw.flush();
    pw.close();
&#125;
</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 读取学生名字和成绩模块 ReadStudentsScores.java</span><br></pre></td></tr></table></figure>
<p>package dingtalkExcel;</p>
<p>import java.io.File;<br>import java.io.FileInputStream;<br>import java.io.FileNotFoundException;<br>import java.io.IOException;<br>import java.math.BigDecimal;<br>import java.math.RoundingMode;<br>import java.util.HashMap;<br>import java.util.Map;</p>
<p>import org.apache.poi.ss.usermodel.Cell;<br>import org.apache.poi.xssf.usermodel.XSSFSheet;<br>import org.apache.poi.xssf.usermodel.XSSFWorkbook;</p>
<p>public class ReadStudentsScores {</p>
<pre><code>private ReadStudentsScores() &#123;

&#125;

private static Map&lt;Object, Object&gt; StudentsScores = new HashMap&lt;Object, Object&gt;();

/**
 * @return the studentsScores
 */
public static Map&lt;Object, Object&gt; getStudentsScores() &#123;
    return StudentsScores;
&#125;

/**
 * &lt;p&gt;
 * 根据cell的具体格式,返回特定的字符串。
 * &lt;/p&gt;
 * &lt;p&gt;
 * 如果cell为null,返回空串。
 * &lt;/p&gt;
 * &lt;p&gt;
 * 如果cell类型为boolean、error、numeric,返回其值(String)。
 * &lt;/p&gt;
 * &lt;p&gt;
 * 如果cell类型为formula,返回保留两位的小数(BigDecimal)。
 * &lt;/p&gt;
 * &lt;p&gt;
 * 如果cell类型为string,那么将空格、换行符和制表符去除,返回去除后的字符串(String)。
 * &lt;/p&gt;
 * 
 * @param cell 要返回其内容的单元格对象
 * @return 其内容。Object可能是String、Double、Boolean等类型。
 */
public static Object getCellValue(Cell cell) &#123;
    if (cell == null) &#123;
        return &quot;&quot;;
    &#125;

    Object obj = null;
    switch (cell.getCellType()) &#123;
    case BOOLEAN:
        obj = (Boolean) cell.getBooleanCellValue();
        break;
    case ERROR:
        obj = cell.getErrorCellValue();
        break;
    case FORMULA:
        try &#123;
            obj = String.valueOf(cell.getStringCellValue());
        &#125; catch (IllegalStateException e) &#123;
            String valueOf = String.valueOf(cell.getNumericCellValue());
            BigDecimal bd = new BigDecimal(Double.valueOf(valueOf));
            bd = bd.setScale(2, RoundingMode.HALF_UP);
            obj = (Double) bd.doubleValue();
        &#125;
        break;
    case NUMERIC:
        obj = cell.getNumericCellValue();
        break;
    case STRING:
        String value = String.valueOf(cell.getStringCellValue());
        value = value.replace(&quot; &quot;, &quot;&quot;);
        value = value.replace(&quot;\n&quot;, &quot;&quot;);
        value = value.replace(&quot;\t&quot;, &quot;&quot;);
        obj = value;
        break;
    default:
        break;
    &#125;
    return obj;
&#125;

/**
 * &lt;p&gt;
 * 读取 &lt;i&gt;excel&lt;/i&gt; 文件内的学生名字和成绩,保存在 &lt;i&gt;StudentsScores&lt;/i&gt; 这个私有成员中
 * &lt;/p&gt;
 * 
 * @param excel      要读取的文件
 * @param sheetindex sheet的下标,从1开始
 * @param scoreindex 成绩保存的列的下标,从1开始
 * @param nameindex  名字保存的列的下标,从1开始
 * @param rowstart   从第几行开始读取数据,从1开始
 * @return 返回StudentsScores
 */
public static Map&lt;Object, Object&gt; readScores(File excel, Integer sheetindex, Integer scoreindex, Integer nameindex,
        Integer rowstart) &#123;
    Logger.Log(&quot;调用readScores函数。&quot;);
    XSSFWorkbook ecl = null;
    try &#123;
        // 要处理的表格文件
        Logger.Log(&quot;in ReadStudentsScores.readScores(), Note: 尝试打开excel文件[&quot; + excel.getName() + &quot;]。&quot;);
        ecl = new XSSFWorkbook(new FileInputStream(excel));
    &#125; catch (FileNotFoundException e) &#123;
        Logger.Error(e.getMessage());// 错误日志
        e.printStackTrace();// 屏幕输出
    &#125; catch (IOException e) &#123;
        Logger.Error(e.getMessage());// 错误日志
        e.printStackTrace();// 屏幕输出
    &#125;
    if (ecl == null) &#123;
        Logger.Error(&quot;in ReadStudentsScores.readScores(), Err: excel文件[&quot; + excel.getName() + &quot;]为空。&quot;);
        return null;
    &#125;
    // 获取指定的sheet
    XSSFSheet sheet = ecl.getSheetAt(sheetindex - 1);// 真实下标从0开始，所以要减1
    if (sheet == null) &#123;
        Logger.Error(&quot;in ReadStudentsScores.readScores(), Err: excel文件中的sheet[&quot; + sheetindex + &quot;]为空。&quot;);
        return null;
    &#125;
    // 获取行数
    Integer lines = sheet.getPhysicalNumberOfRows();
    // 循环遍历每一行,找到每一行中的姓名和成绩
    for (int i = rowstart - 1; i &lt;= lines; i++) &#123;
        Logger.Log(&quot;in ReadStudentsScores.readScores(), Note: 开始遍历sheet[&quot; + sheetindex + &quot;],line[&quot; + i + &quot;]。&quot;);
</code></pre><p>//            System.out.println(“Debug: Row=” + i);//Debug_Print</p>
<pre><code>        if (sheet.getRow(i) == null) &#123;
            // 如果为null,不继续循环
            continue;
        &#125;
</code></pre><p>//            System.out.println(“Debug This row is alive.”);//Debug_Print</p>
<pre><code>        // 找到每一行的姓名和成绩
        Cell name = sheet.getRow(i).getCell(nameindex - 1);// 真实下标从0开始，所以要减1
        Cell score = sheet.getRow(i).getCell(scoreindex - 1);// 真实下标从0开始，所以要减1
        if (name == null) &#123;
            // 如果为null,不添加进map
            continue;
        &#125;
</code></pre><p>//            System.out.println(“Debug These cells are alive.”);//Debug_Print</p>
<pre><code>        // 将姓名和分数添加到map中

        if (StudentsScores.containsKey(getCellValue(name))) &#123;
            // 如果存在重复的名字
            Logger.Error(&quot;in ReadStudentsScores.readScores(), Err: 存在重复的名字！&quot;);// 错误日志
            return null;
        &#125;

        StudentsScores.put(getCellValue(name), getCellValue(score));// 添加名字和他的分数
    &#125;
    return StudentsScores;

&#125;
</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 写入学生成绩模块 WriteStudentsScores.java</span><br></pre></td></tr></table></figure>
<p>package dingtalkExcel;</p>
<p>import java.io.File;<br>import java.io.FileNotFoundException;<br>import java.io.FileOutputStream;<br>import java.io.IOException;<br>import java.util.Map;</p>
<p>import org.apache.poi.openxml4j.exceptions.InvalidFormatException;<br>import org.apache.poi.xssf.usermodel.XSSFCell;<br>import org.apache.poi.xssf.usermodel.XSSFSheet;<br>import org.apache.poi.xssf.usermodel.XSSFWorkbook;</p>
<p>public class WriteStudentsScores {</p>
<pre><code>private WriteStudentsScores() &#123;

&#125;

/**
 * 输出 &lt;i&gt;workbook&lt;/i&gt; (修改好的excel对象)到指定文件 &lt;i&gt;output&lt;/i&gt;
 * 
 * @param workbook 修改好的excel对象
 * @param output   输出的文件
 */
public static void writeWorkbookToFile(XSSFWorkbook workbook, File output) &#123;
    FileOutputStream outputStream = null;
    if (output.isDirectory()) &#123;
        // 如果输出文件地址为目录
        Logger.Error(&quot;in WriteStudentsScores.writeScores(), Err: 输出文件路径为目录！&quot;);
        return;
    &#125;
    if (output.exists()) &#123;
        // 如果已经存在文件,删掉它,避免不必要的麻烦
        output.delete();
    &#125;
    if (!output.getParentFile().exists()) &#123;
        // 如果父目录没有创建,创建父目录
        output.getParentFile().mkdirs();
    &#125;
    if (!output.exists()) &#123;
        try &#123;
            output.createNewFile();
            // 如果没有创建过文件,当然此处一定没有创建过,因为上面删掉了
        &#125; catch (IOException e) &#123;
            Logger.Error(e.getMessage());
            e.printStackTrace();
        &#125;
    &#125;
    try &#123;
        outputStream = new FileOutputStream(output);// 创建输出的实例
    &#125; catch (FileNotFoundException e1) &#123;
        Logger.Error(e1.getMessage());
        e1.printStackTrace();
    &#125;
    try &#123;
        workbook.write(outputStream);// 输出workbook(修改好的excel对象)到指定文件
    &#125; catch (IOException e) &#123;
        Logger.Error(e.getMessage());
        e.printStackTrace();
    &#125;
&#125;

/**
 * &lt;p&gt;
 * 从指定文件的指定行读取学生信息后,按照另一个文件的顺序写入成绩
 * &lt;/p&gt;
 * 
 * @param mp         储存学生姓名和成绩的map
 * @param sheetindex 要写入文件的sheet的下标,从1开始
 * @param scoreindex 要写入文件的成绩保存的列的下标,从1开始
 * @param nameindex  要写入文件的名字保存的列的下标,从1开始
 * @param outfile    要写入的文件
 * @param rowstart   从第几行开始写入数据,从1开始
 */
public static void writeScores(Map&lt;Object, Object&gt; mp, Integer sheetindex, Integer scoreindex, Integer nameindex,
        File outfile, Integer rowstart) &#123;

    XSSFWorkbook oxcl = null;

    try &#123;
        // 打开要写入的excel文件
        Logger.Log(&quot;in WriteStudentsScores.writeScores(), Note: 尝试打开excel文件[&quot; + outfile.getName() + &quot;]。&quot;);
        oxcl = new XSSFWorkbook(outfile);
    &#125; catch (InvalidFormatException e) &#123;
        Logger.Error(e.getMessage());
        e.printStackTrace();
    &#125; catch (IOException e) &#123;
        Logger.Error(e.getMessage());
        e.printStackTrace();
    &#125;
    if (oxcl == null) &#123;
        Logger.Error(&quot;in WriteStudentsScores.writeScores(), Err: 要修改的excel文件[&quot; + outfile.getName()
                + &quot;]为null！\n请检查是否存在这个文件！&quot;);// 错误日志
        return;
    &#125;
    // 找到要修改的sheet
    XSSFSheet sheet = oxcl.getSheetAt(sheetindex - 1);
    if (sheet == null) &#123;
        Logger.Error(&quot;in ReadStudentsScores.readScores(), Err: excel文件中的sheet[&quot; + sheetindex + &quot;]为空。&quot;);
        return;
    &#125;
    for (int i = rowstart - 1; i &lt;= sheet.getPhysicalNumberOfRows(); i++) &#123;
        if (sheet.getRow(i) == null) &#123;
            // 如果当前行为null,跳过当前行
            continue;
        &#125;
        XSSFCell nameCell, scoreCell;
        // 从要修改的sheet中找到名字单元格和成绩单元格
        // 名字单元格用来查找,,成绩单元格用来写入
        nameCell = sheet.getRow(i).getCell(nameindex - 1);
        scoreCell = sheet.getRow(i).getCell(scoreindex - 1);
        if (nameCell == null) &#123;
            // 如果名字单元格为null,无法继续进行查找并修改
            continue;
        &#125;
        if (scoreCell == null) &#123;
            // 如果要修改的成绩单元格为null,那么我们需要新建一个单元格
            scoreCell = sheet.getRow(i).createCell(scoreindex - 1);
        &#125;
        // 寻找mp中是否有这个名字的成绩
        Object scoreObj = mp.get(ReadStudentsScores.getCellValue(nameCell));
        if (scoreObj == null) &#123;
            // 如果没有,设置这个Obj为(Double)0.0
            scoreObj = (Double) 0.0;
        &#125;
        if (scoreObj instanceof Double) &#123;// 如果是Double类型
            scoreCell.setCellValue((double) scoreObj);// 类型转换
        &#125; else if (scoreObj instanceof String) &#123;// 如果是String类型
            scoreCell.setCellValue((String) scoreObj);// 类型转换
        &#125; else &#123;// 如果两种都不是
            Logger.Error(&quot;in WriteStudentsScores.writeScores(), Err: 判断scoreObj类型的时候既不是String也不是Double。请联系作者。&quot;);
            return;
        &#125;
    &#125;
    writeWorkbookToFile(oxcl, outfile);
&#125;
</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 入口程序 </span><br></pre></td></tr></table></figure>
<p>package dingtalkExcel;</p>
<p>import java.io.File;<br>import java.util.Map;<br>import java.util.Scanner;</p>
<p>public class Start {</p>
<pre><code>public static void main(String[] args) &#123;

    Logger.Log(&quot;主程序开始。&quot;);
    Scanner sc = new Scanner(System.in);

    System.out.print(&quot;请输入成绩来源的excel表格(xlsx)文件路径: &quot;);
    String infile = sc.nextLine();
    System.out.print(&quot;请输入成绩来源的工作表序号(从1开始): &quot;);
    Integer insheet = sc.nextInt();
    System.out.print(&quot;请输入成绩来源的姓名列数(从1开始): &quot;);
    Integer inname = sc.nextInt();
    System.out.print(&quot;请输入成绩来源的成绩列数(从1开始): &quot;);
    Integer inscore = sc.nextInt();
    System.out.print(&quot;请输入从第几行开始读取数据(从1开始): &quot;);
    Integer inrow = sc.nextInt();

    sc.nextLine();

    System.out.print(&quot;请输入导出成绩的excel表格(xlsx)文件路径: &quot;);
    String outfile = sc.nextLine();
    System.out.print(&quot;请输入导出成绩的工作表序号(从1开始): &quot;);
    Integer outsheet = sc.nextInt();
    System.out.print(&quot;请输入导出成绩的姓名列数(从1开始): &quot;);
    Integer outname = sc.nextInt();
    System.out.print(&quot;请输入导出成绩的成绩列数(从1开始): &quot;);
    Integer outscore = sc.nextInt();
    System.out.print(&quot;请输入从第几行开始写入数据(从1开始): &quot;);
    Integer outrow = sc.nextInt();
</code></pre><p>//        sc.nextLine();<br>        System.out.println(“正在处理中…”);<br>        Map<Object, Object> mp = ReadStudentsScores.readScores(new File(infile), insheet, inscore, inname, inrow);<br>        if (mp != null) {<br>            System.out.println(“获取map成功…”);<br>            WriteStudentsScores.writeScores(mp, outsheet, outscore, outname, new File(outfile), outrow);<br>        }</p>
<pre><code>    sc.close();

&#125;
</code></pre><p>}</p>
<p>```</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag"># 编程</a>
              <a href="/tags/%E7%94%B5%E8%84%91%E5%B7%A5%E5%85%B7/" rel="tag"># 电脑工具</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/10/19/%E6%95%B0%E5%AD%A6%E8%87%AA%E7%BC%96%E9%A2%98-2020-10/" rel="prev" title="数学自编题-2020.10">
      <i class="fa fa-chevron-left"></i> 数学自编题-2020.10
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%92%89%E9%92%89excel%E6%88%90%E7%BB%A9%E4%B8%8A%E4%BC%A0%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B7%A5%E5%85%B7"><span class="nav-number">1.</span> <span class="nav-text">钉钉excel成绩上传格式化工具</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">李坚蔚</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李坚蔚</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>

<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="钉钉的成绩上传很烦人，成绩要按照顺序一个一个输入。。。太麻烦了。所以要用科技改变生活。程序猿走起！">
<meta property="og:type" content="article">
<meta property="og:title" content="excel处理">
<meta property="og:url" content="http://yoursite.com/2020/11/07/%E7%BC%96%E7%A8%8B/excel%E5%A4%84%E7%90%86/index.html">
<meta property="og:site_name" content="李坚蔚 の Blog">
<meta property="og:description" content="钉钉的成绩上传很烦人，成绩要按照顺序一个一个输入。。。太麻烦了。所以要用科技改变生活。程序猿走起！">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-11-07T00:40:20.000Z">
<meta property="article:modified_time" content="2020-12-07T13:56:39.449Z">
<meta property="article:author" content="李坚蔚">
<meta property="article:tag" content="编程">
<meta property="article:tag" content="电脑工具">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2020/11/07/%E7%BC%96%E7%A8%8B/excel%E5%A4%84%E7%90%86/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>excel处理 | 李坚蔚 の Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">李坚蔚 の Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/11/07/%E7%BC%96%E7%A8%8B/excel%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李坚蔚">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李坚蔚 の Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          excel处理
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-11-07 08:40:20" itemprop="dateCreated datePublished" datetime="2020-11-07T08:40:20+08:00">2020-11-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-07 21:56:39" itemprop="dateModified" datetime="2020-12-07T21:56:39+08:00">2020-12-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>钉钉的成绩上传很烦人，成绩要按照顺序一个一个输入。。。<br>太麻烦了。<br>所以要用科技改变生活。<br>程序猿走起！<br><a id="more"></a></p>
<h1 id="钉钉excel成绩上传格式化工具"><a href="#钉钉excel成绩上传格式化工具" class="headerlink" title="钉钉excel成绩上传格式化工具"></a>钉钉excel成绩上传格式化工具</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">目前版本：Version 1.0-Beta</span><br><span class="line">开发环境：eclipse, JavaSE-12</span><br></pre></td></tr></table></figure>
<h2 id="Version-1-0-Beta-Date-2020-11-07-16-30"><a href="#Version-1-0-Beta-Date-2020-11-07-16-30" class="headerlink" title="Version 1.0-Beta Date:2020.11.07 16:30"></a>Version 1.0-Beta Date:2020.11.07 16:30</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>java处理excel表格工具有很多，比如jxl.jar。<br>从网上下载jxl.jar之后，在eclipse项目文件夹下新建一个lib文件夹（当然名字可以随意，但是我习惯于起名为lib），将jxl.jar放在lib文件夹内。<br>回到eclipse，选中项目，右键，点击Reflash（按下F5即可），可以看到lib文件夹已经出现在eclipse中了。<br>展开lib文件夹，选中jxl.jar，右键，选中Build Path-&gt;Configure Build Path，就可以看到出现了一个Referenced Libraries。这时，在项目中就可以使用jxl.jar中的方法了！</p>
<p>但是，发现jxl.jar只能处理03年以前的文件。</p>
<p>所以改成使用poi来实现这个功能。同样，下载后加载到Referenced Libraries。</p>
<h3 id="日志模块-Log-java"><a href="#日志模块-Log-java" class="headerlink" title="日志模块 Log.java"></a>日志模块 Log.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line">package dingtalkExcel;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileWriter;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">import javax.swing.JOptionPane;</span><br><span class="line"></span><br><span class="line">public class Logger &#123;</span><br><span class="line">    private Logger() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final static File ERRORLOGFILE &#x3D; new File(&quot;.\\Logger\\error.log&quot;);&#x2F;&#x2F; 错误log日志文件默认保存地址</span><br><span class="line">    public final static File LOG &#x3D; new File(&quot;.\\Logger\\ScoreFormat.log&quot;);&#x2F;&#x2F; 操作log日志文件默认保存地址</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 这个方法用于提示用户异常信息 &lt;i&gt;Msg&lt;&#x2F;i&gt; 并且储存到文件 &lt;i&gt;logfile&lt;&#x2F;i&gt; 中。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param Msg       错误消息</span><br><span class="line">     * @param errorfile 保存错误日志的文件</span><br><span class="line">     * @param logfile   保存普通日志的文件</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void Error(String Msg, File errorfile, File logfile) &#123;</span><br><span class="line"></span><br><span class="line">        if (!errorfile.getParentFile().exists()) &#123;</span><br><span class="line">            errorfile.getParentFile().mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        if (!errorfile.exists()) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                errorfile.createNewFile();</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; &#x2F;&#x2F; 如果文件没有创建，则创建之</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 先显示人性化提示内容</span><br><span class="line">        String m &#x3D; new String(&quot;不好意思,出现了一个异常。&quot;);</span><br><span class="line">        JOptionPane.showMessageDialog(null, m, &quot;错误提示&quot;, JOptionPane.PLAIN_MESSAGE, null);</span><br><span class="line">        &#x2F;&#x2F; 再显示异常的具体信息</span><br><span class="line">        JOptionPane.showMessageDialog(null, Msg, &quot;错误提示&quot;, JOptionPane.PLAIN_MESSAGE, null);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 然后输出到error文件中</span><br><span class="line">        FileWriter fw &#x3D; null;</span><br><span class="line">        try &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果文件存在,则追加内容；如果文件不存在,则创建文件</span><br><span class="line">            fw &#x3D; new FileWriter(errorfile, true);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        PrintWriter pw &#x3D; new PrintWriter(fw);</span><br><span class="line">        &#x2F;&#x2F; log文件的内容设计</span><br><span class="line">        String errStr &#x3D; &quot;----[Time:&quot; + new Date().toString() + &quot;] Exception Caused----\n&quot; + Msg</span><br><span class="line">                + &quot;\n--------------------------------------------------------------------------------&quot;;</span><br><span class="line">        &#x2F;&#x2F; 追加输出</span><br><span class="line">        pw.println(errStr);</span><br><span class="line">        pw.flush();</span><br><span class="line">        pw.close();</span><br><span class="line"></span><br><span class="line">        Log(errStr, logfile);&#x2F;&#x2F; 继续输出到log文件</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 这个方法用于提示用户异常信息 &lt;i&gt;Msg&lt;&#x2F;i&gt; 并且储存到默认文件 &lt;i&gt;ERRORLOGFILE&lt;&#x2F;i&gt; 中。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param Msg 错误消息</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void Error(String Msg) &#123;</span><br><span class="line">        Error(Msg, ERRORLOGFILE, LOG);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 这个方法用于储存日志 &lt;i&gt;Msg&lt;&#x2F;i&gt; 到默认文件 &lt;i&gt;LOG&lt;&#x2F;i&gt; 中。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param Msg 日志信息</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void Log(String Msg) &#123;</span><br><span class="line">        Log(Msg, LOG);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 这个方法用于储存日志 &lt;i&gt;Msg&lt;&#x2F;i&gt; 到文件 &lt;i&gt;logfile&lt;&#x2F;i&gt; 中。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param Msg     日志信息</span><br><span class="line">     * @param logfile 保存的文件</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void Log(String Msg, File logfile) &#123;</span><br><span class="line"></span><br><span class="line">        if (!logfile.getParentFile().exists()) &#123;</span><br><span class="line">            logfile.getParentFile().mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        if (!logfile.exists()) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                logfile.createNewFile();</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; &#x2F;&#x2F; 如果文件没有创建，则创建之</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 输出log</span><br><span class="line">        FileWriter fw &#x3D; null;</span><br><span class="line">        try &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果文件存在,则追加内容；如果文件不存在,则创建文件</span><br><span class="line">            fw &#x3D; new FileWriter(logfile, true);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        PrintWriter pw &#x3D; new PrintWriter(fw);</span><br><span class="line">        &#x2F;&#x2F; log文件的内容设计</span><br><span class="line">        String logStr &#x3D; &quot;----[Time:&quot; + new Date().toString() + &quot;] Logger----\n&quot; + Msg</span><br><span class="line">                + &quot;\n----------------------------------------------------------------------&quot;;</span><br><span class="line">        &#x2F;&#x2F; 追加输出</span><br><span class="line">        pw.println(logStr);</span><br><span class="line">        pw.flush();</span><br><span class="line">        pw.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="读取学生名字和成绩模块-ReadStudentsScores-java"><a href="#读取学生名字和成绩模块-ReadStudentsScores-java" class="headerlink" title="读取学生名字和成绩模块 ReadStudentsScores.java"></a>读取学生名字和成绩模块 ReadStudentsScores.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">package dingtalkExcel;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.math.BigDecimal;</span><br><span class="line">import java.math.RoundingMode;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import org.apache.poi.ss.usermodel.Cell;</span><br><span class="line">import org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line">import org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line">public class ReadStudentsScores &#123;</span><br><span class="line"></span><br><span class="line">    private ReadStudentsScores() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static Map&lt;Object, Object&gt; StudentsScores &#x3D; new HashMap&lt;Object, Object&gt;();</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * @return the studentsScores</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static Map&lt;Object, Object&gt; getStudentsScores() &#123;</span><br><span class="line">        return StudentsScores;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 根据cell的具体格式,返回特定的字符串。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 如果cell为null,返回空串。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 如果cell类型为boolean、error、numeric,返回其值(String)。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 如果cell类型为formula,返回保留两位的小数(BigDecimal)。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 如果cell类型为string,那么将空格、换行符和制表符去除,返回去除后的字符串(String)。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param cell 要返回其内容的单元格对象</span><br><span class="line">     * @return 其内容。Object可能是String、Double、Boolean等类型。</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static Object getCellValue(Cell cell) &#123;</span><br><span class="line">        if (cell &#x3D;&#x3D; null) &#123;</span><br><span class="line">            return &quot;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Object obj &#x3D; null;</span><br><span class="line">        switch (cell.getCellType()) &#123;</span><br><span class="line">        case BOOLEAN:</span><br><span class="line">            obj &#x3D; (Boolean) cell.getBooleanCellValue();</span><br><span class="line">            break;</span><br><span class="line">        case ERROR:</span><br><span class="line">            obj &#x3D; cell.getErrorCellValue();</span><br><span class="line">            break;</span><br><span class="line">        case FORMULA:</span><br><span class="line">            try &#123;</span><br><span class="line">                obj &#x3D; String.valueOf(cell.getStringCellValue());</span><br><span class="line">            &#125; catch (IllegalStateException e) &#123;</span><br><span class="line">                String valueOf &#x3D; String.valueOf(cell.getNumericCellValue());</span><br><span class="line">                BigDecimal bd &#x3D; new BigDecimal(Double.valueOf(valueOf));</span><br><span class="line">                bd &#x3D; bd.setScale(2, RoundingMode.HALF_UP);</span><br><span class="line">                obj &#x3D; (Double) bd.doubleValue();</span><br><span class="line">            &#125;</span><br><span class="line">            break;</span><br><span class="line">        case NUMERIC:</span><br><span class="line">            obj &#x3D; cell.getNumericCellValue();</span><br><span class="line">            break;</span><br><span class="line">        case STRING:</span><br><span class="line">            String value &#x3D; String.valueOf(cell.getStringCellValue());</span><br><span class="line">            value &#x3D; value.replace(&quot; &quot;, &quot;&quot;);</span><br><span class="line">            value &#x3D; value.replace(&quot;\n&quot;, &quot;&quot;);</span><br><span class="line">            value &#x3D; value.replace(&quot;\t&quot;, &quot;&quot;);</span><br><span class="line">            obj &#x3D; value;</span><br><span class="line">            break;</span><br><span class="line">        default:</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">        return obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 读取 &lt;i&gt;excel&lt;&#x2F;i&gt; 文件内的学生名字和成绩,保存在 &lt;i&gt;StudentsScores&lt;&#x2F;i&gt; 这个私有成员中</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param excel      要读取的文件</span><br><span class="line">     * @param sheetindex sheet的下标,从1开始</span><br><span class="line">     * @param scoreindex 成绩保存的列的下标,从1开始</span><br><span class="line">     * @param nameindex  名字保存的列的下标,从1开始</span><br><span class="line">     * @param rowstart   从第几行开始读取数据,从1开始</span><br><span class="line">     * @return 返回StudentsScores</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static Map&lt;Object, Object&gt; readScores(File excel, Integer sheetindex, Integer scoreindex, Integer nameindex,</span><br><span class="line">            Integer rowstart) &#123;</span><br><span class="line">        Logger.Log(&quot;调用readScores函数。&quot;);</span><br><span class="line">        XSSFWorkbook ecl &#x3D; null;</span><br><span class="line">        try &#123;</span><br><span class="line">            &#x2F;&#x2F; 要处理的表格文件</span><br><span class="line">            Logger.Log(&quot;in ReadStudentsScores.readScores(), Note: 尝试打开excel文件[&quot; + excel.getName() + &quot;]。&quot;);</span><br><span class="line">            ecl &#x3D; new XSSFWorkbook(new FileInputStream(excel));</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            Logger.Error(e.getMessage());&#x2F;&#x2F; 错误日志</span><br><span class="line">            e.printStackTrace();&#x2F;&#x2F; 屏幕输出</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            Logger.Error(e.getMessage());&#x2F;&#x2F; 错误日志</span><br><span class="line">            e.printStackTrace();&#x2F;&#x2F; 屏幕输出</span><br><span class="line">        &#125;</span><br><span class="line">        if (ecl &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScores(), Err: excel文件[&quot; + excel.getName() + &quot;]为空。&quot;);</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 获取指定的sheet</span><br><span class="line">        XSSFSheet sheet &#x3D; ecl.getSheetAt(sheetindex - 1);&#x2F;&#x2F; 真实下标从0开始，所以要减1</span><br><span class="line">        if (sheet &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScores(), Err: excel文件中的sheet[&quot; + sheetindex + &quot;]为空。&quot;);</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 获取行数</span><br><span class="line">        Integer lines &#x3D; sheet.getPhysicalNumberOfRows();</span><br><span class="line">        &#x2F;&#x2F; 循环遍历每一行,找到每一行中的姓名和成绩</span><br><span class="line">        for (int i &#x3D; rowstart - 1; i &lt;&#x3D; lines; i++) &#123;</span><br><span class="line">            Logger.Log(&quot;in ReadStudentsScores.readScores(), Note: 开始遍历sheet[&quot; + sheetindex + &quot;],line[&quot; + i + &quot;]。&quot;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;            System.out.println(&quot;Debug: Row&#x3D;&quot; + i);&#x2F;&#x2F;Debug_Print</span><br><span class="line"></span><br><span class="line">            if (sheet.getRow(i) &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果为null,不继续循环</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;            System.out.println(&quot;Debug This row is alive.&quot;);&#x2F;&#x2F;Debug_Print</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; 找到每一行的姓名和成绩</span><br><span class="line">            Cell name &#x3D; sheet.getRow(i).getCell(nameindex - 1);&#x2F;&#x2F; 真实下标从0开始，所以要减1</span><br><span class="line">            Cell score &#x3D; sheet.getRow(i).getCell(scoreindex - 1);&#x2F;&#x2F; 真实下标从0开始，所以要减1</span><br><span class="line">            if (name &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果为null,不添加进map</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;            System.out.println(&quot;Debug These cells are alive.&quot;);&#x2F;&#x2F;Debug_Print</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; 将姓名和分数添加到map中</span><br><span class="line"></span><br><span class="line">            if (StudentsScores.containsKey(getCellValue(name))) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果存在重复的名字</span><br><span class="line">                Logger.Error(&quot;in ReadStudentsScores.readScores(), Err: 存在重复的名字！&quot;);&#x2F;&#x2F; 错误日志</span><br><span class="line">                return null;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            StudentsScores.put(getCellValue(name), getCellValue(score));&#x2F;&#x2F; 添加名字和他的分数</span><br><span class="line">        &#125;</span><br><span class="line">        return StudentsScores;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="写入学生成绩模块-WriteStudentsScores-java"><a href="#写入学生成绩模块-WriteStudentsScores-java" class="headerlink" title="写入学生成绩模块 WriteStudentsScores.java"></a>写入学生成绩模块 WriteStudentsScores.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">package dingtalkExcel;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import org.apache.poi.openxml4j.exceptions.InvalidFormatException;</span><br><span class="line">import org.apache.poi.xssf.usermodel.XSSFCell;</span><br><span class="line">import org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line">import org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line">public class WriteStudentsScores &#123;</span><br><span class="line"></span><br><span class="line">    private WriteStudentsScores() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 输出 &lt;i&gt;workbook&lt;&#x2F;i&gt; (修改好的excel对象)到指定文件 &lt;i&gt;output&lt;&#x2F;i&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param workbook 修改好的excel对象</span><br><span class="line">     * @param output   输出的文件</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void writeWorkbookToFile(XSSFWorkbook workbook, File output) &#123;</span><br><span class="line">        FileOutputStream outputStream &#x3D; null;</span><br><span class="line">        if (output.isDirectory()) &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果输出文件地址为目录</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeScores(), Err: 输出文件路径为目录！&quot;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        if (output.exists()) &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果已经存在文件,删掉它,避免不必要的麻烦</span><br><span class="line">            output.delete();</span><br><span class="line">        &#125;</span><br><span class="line">        if (!output.getParentFile().exists()) &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果父目录没有创建,创建父目录</span><br><span class="line">            output.getParentFile().mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        if (!output.exists()) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                output.createNewFile();</span><br><span class="line">                &#x2F;&#x2F; 如果没有创建过文件,当然此处一定没有创建过,因为上面删掉了</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                Logger.Error(e.getMessage());</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            outputStream &#x3D; new FileOutputStream(output);&#x2F;&#x2F; 创建输出的实例</span><br><span class="line">        &#125; catch (FileNotFoundException e1) &#123;</span><br><span class="line">            Logger.Error(e1.getMessage());</span><br><span class="line">            e1.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            workbook.write(outputStream);&#x2F;&#x2F; 输出workbook(修改好的excel对象)到指定文件</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            Logger.Error(e.getMessage());</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 从指定文件的指定行读取学生信息后,按照另一个文件的顺序写入成绩</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param mp         储存学生姓名和成绩的map</span><br><span class="line">     * @param sheetindex 要写入文件的sheet的下标,从1开始</span><br><span class="line">     * @param scoreindex 要写入文件的成绩保存的列的下标,从1开始</span><br><span class="line">     * @param nameindex  要写入文件的名字保存的列的下标,从1开始</span><br><span class="line">     * @param outfile    要写入的文件</span><br><span class="line">     * @param rowstart   从第几行开始写入数据,从1开始</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void writeScores(Map&lt;Object, Object&gt; mp, Integer sheetindex, Integer scoreindex, Integer nameindex,</span><br><span class="line">            File outfile, Integer rowstart) &#123;</span><br><span class="line"></span><br><span class="line">        XSSFWorkbook oxcl &#x3D; null;</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            &#x2F;&#x2F; 打开要写入的excel文件</span><br><span class="line">            Logger.Log(&quot;in WriteStudentsScores.writeScores(), Note: 尝试打开excel文件[&quot; + outfile.getName() + &quot;]。&quot;);</span><br><span class="line">            oxcl &#x3D; new XSSFWorkbook(outfile);</span><br><span class="line">        &#125; catch (InvalidFormatException e) &#123;</span><br><span class="line">            Logger.Error(e.getMessage());</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            Logger.Error(e.getMessage());</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        if (oxcl &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeScores(), Err: 要修改的excel文件[&quot; + outfile.getName()</span><br><span class="line">                    + &quot;]为null！\n请检查是否存在这个文件！&quot;);&#x2F;&#x2F; 错误日志</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 找到要修改的sheet</span><br><span class="line">        XSSFSheet sheet &#x3D; oxcl.getSheetAt(sheetindex - 1);</span><br><span class="line">        if (sheet &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScores(), Err: excel文件中的sheet[&quot; + sheetindex + &quot;]为空。&quot;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        for (int i &#x3D; rowstart - 1; i &lt;&#x3D; sheet.getPhysicalNumberOfRows(); i++) &#123;</span><br><span class="line">            if (sheet.getRow(i) &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果当前行为null,跳过当前行</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line">            XSSFCell nameCell, scoreCell;</span><br><span class="line">            &#x2F;&#x2F; 从要修改的sheet中找到名字单元格和成绩单元格</span><br><span class="line">            &#x2F;&#x2F; 名字单元格用来查找,,成绩单元格用来写入</span><br><span class="line">            nameCell &#x3D; sheet.getRow(i).getCell(nameindex - 1);</span><br><span class="line">            scoreCell &#x3D; sheet.getRow(i).getCell(scoreindex - 1);</span><br><span class="line">            if (nameCell &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果名字单元格为null,无法继续进行查找并修改</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line">            if (scoreCell &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果要修改的成绩单元格为null,那么我们需要新建一个单元格</span><br><span class="line">                scoreCell &#x3D; sheet.getRow(i).createCell(scoreindex - 1);</span><br><span class="line">            &#125;</span><br><span class="line">            &#x2F;&#x2F; 寻找mp中是否有这个名字的成绩</span><br><span class="line">            Object scoreObj &#x3D; mp.get(ReadStudentsScores.getCellValue(nameCell));</span><br><span class="line">            if (scoreObj &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果没有,设置这个Obj为(Double)0.0</span><br><span class="line">                scoreObj &#x3D; (Double) 0.0;</span><br><span class="line">            &#125;</span><br><span class="line">            if (scoreObj instanceof Double) &#123;&#x2F;&#x2F; 如果是Double类型</span><br><span class="line">                scoreCell.setCellValue((double) scoreObj);&#x2F;&#x2F; 类型转换</span><br><span class="line">            &#125; else if (scoreObj instanceof String) &#123;&#x2F;&#x2F; 如果是String类型</span><br><span class="line">                scoreCell.setCellValue((String) scoreObj);&#x2F;&#x2F; 类型转换</span><br><span class="line">            &#125; else &#123;&#x2F;&#x2F; 如果两种都不是</span><br><span class="line">                Logger.Error(&quot;in WriteStudentsScores.writeScores(), Err: 判断scoreObj类型的时候既不是String也不是Double。请联系作者。&quot;);</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        writeWorkbookToFile(oxcl, outfile);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="入口程序-Start-java"><a href="#入口程序-Start-java" class="headerlink" title="入口程序 Start.java"></a>入口程序 Start.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">package dingtalkExcel;</span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.util.Map;</span><br><span class="line">import java.util.Scanner;</span><br><span class="line"></span><br><span class="line">public class Start &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        Logger.Log(&quot;主程序开始。&quot;);</span><br><span class="line">        Scanner sc &#x3D; new Scanner(System.in);</span><br><span class="line"></span><br><span class="line">        System.out.print(&quot;请输入成绩来源的excel表格(xlsx)文件路径: &quot;);</span><br><span class="line">        String infile &#x3D; sc.nextLine();</span><br><span class="line">        System.out.print(&quot;请输入成绩来源的工作表序号(从1开始): &quot;);</span><br><span class="line">        Integer insheet &#x3D; sc.nextInt();</span><br><span class="line">        System.out.print(&quot;请输入成绩来源的姓名列数(从1开始): &quot;);</span><br><span class="line">        Integer inname &#x3D; sc.nextInt();</span><br><span class="line">        System.out.print(&quot;请输入成绩来源的成绩列数(从1开始): &quot;);</span><br><span class="line">        Integer inscore &#x3D; sc.nextInt();</span><br><span class="line">        System.out.print(&quot;请输入从第几行开始读取数据(从1开始): &quot;);</span><br><span class="line">        Integer inrow &#x3D; sc.nextInt();</span><br><span class="line"></span><br><span class="line">        sc.nextLine();</span><br><span class="line"></span><br><span class="line">        System.out.print(&quot;请输入导出成绩的excel表格(xlsx)文件路径: &quot;);</span><br><span class="line">        String outfile &#x3D; sc.nextLine();</span><br><span class="line">        System.out.print(&quot;请输入导出成绩的工作表序号(从1开始): &quot;);</span><br><span class="line">        Integer outsheet &#x3D; sc.nextInt();</span><br><span class="line">        System.out.print(&quot;请输入导出成绩的姓名列数(从1开始): &quot;);</span><br><span class="line">        Integer outname &#x3D; sc.nextInt();</span><br><span class="line">        System.out.print(&quot;请输入导出成绩的成绩列数(从1开始): &quot;);</span><br><span class="line">        Integer outscore &#x3D; sc.nextInt();</span><br><span class="line">        System.out.print(&quot;请输入从第几行开始写入数据(从1开始): &quot;);</span><br><span class="line">        Integer outrow &#x3D; sc.nextInt();</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;        sc.nextLine();</span><br><span class="line">        System.out.println(&quot;正在处理中...&quot;);</span><br><span class="line">        Map&lt;Object, Object&gt; mp &#x3D; ReadStudentsScores.readScores(new File(infile), insheet, inscore, inname, inrow);</span><br><span class="line">        if (mp !&#x3D; null) &#123;</span><br><span class="line">            System.out.println(&quot;获取map成功...&quot;);</span><br><span class="line">            WriteStudentsScores.writeScores(mp, outsheet, outscore, outname, new File(outfile), outrow);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        sc.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Version-3-3-Date-2020-12-07-21-50"><a href="#Version-3-3-Date-2020-12-07-21-50" class="headerlink" title="Version 3.3 Date:2020.12.07 21:50"></a>Version 3.3 Date:2020.12.07 21:50</h2><h3 id="文件复制模块-FileCopyUtils-java"><a href="#文件复制模块-FileCopyUtils-java" class="headerlink" title="文件复制模块 FileCopyUtils.java"></a>文件复制模块 FileCopyUtils.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">package dingtalkExcel;</span><br><span class="line"></span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">public class FileCopyUtils &#123;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;    实现对目录的复制</span><br><span class="line">&#x2F;&#x2F;    在复制目录的过程中判断源文件下所有文件对象是否为目录，是的话则利用递归调用自己复制目录</span><br><span class="line">&#x2F;&#x2F;    如果是文件的话，则调用copyFile方法复制文件</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 实现对目录的复制</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 在复制目录的过程中判断源文件下所有文件对象是否为目录，是的话则利用递归调用自己复制目录</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param srcPath  等待备份的目录</span><br><span class="line">     * @param destPath 备份文件目录</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void copyDir(String srcPath, String destPath) &#123;</span><br><span class="line">        File src &#x3D; new File(srcPath);&#x2F;&#x2F; 源头</span><br><span class="line">        File dest &#x3D; new File(destPath);&#x2F;&#x2F; 目的地</span><br><span class="line">        &#x2F;&#x2F; 判断是否为目录，不存在则不作操作</span><br><span class="line">        if (!src.isDirectory()) &#123;</span><br><span class="line">            Logger.Error(&quot;备份文件模块,in copyDir(), Err: 不是目录!&quot;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 判断目的地目录是否存在，不存在就创建目录</span><br><span class="line">        if (!dest.exists()) &#123;</span><br><span class="line">            dest.mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 获取源头目录下的文件列表，每个对象代表一个目录或者文件</span><br><span class="line">        File[] srcList &#x3D; src.listFiles();</span><br><span class="line">        if (null !&#x3D; srcList &amp;&amp; srcList.length &gt; 0) &#123;</span><br><span class="line">            &#x2F;&#x2F; 遍历源头目录下的文件列表</span><br><span class="line">            for (File aSrcList : srcList) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果是目录的话</span><br><span class="line">                if (aSrcList.isDirectory()) &#123;</span><br><span class="line">                    &#x2F;&#x2F; 递归调用复制该目录</span><br><span class="line">                    copyDir(srcPath + File.separator + aSrcList.getName(),</span><br><span class="line">                            destPath + File.separator + aSrcList.getName());</span><br><span class="line">                    &#x2F;&#x2F; 如果是文件的话</span><br><span class="line">                &#125; else if (aSrcList.isFile()) &#123;</span><br><span class="line">                    &#x2F;&#x2F; 递归复制该文件</span><br><span class="line">                    copyFile(srcPath + File.separator + aSrcList.getName(),</span><br><span class="line">                            destPath + File.separator + aSrcList.getName());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#x2F;&#x2F;        boolean delete &#x3D; src.delete();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;    实现对文件的复制</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 实现对文件的复制</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param isFile 等待备份的文件</span><br><span class="line">     * @param osFile 备份文件路径</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void copyFile(String isFile, String osFile) &#123;</span><br><span class="line"></span><br><span class="line">        InputStream is &#x3D; null;</span><br><span class="line">        OutputStream os &#x3D; null;</span><br><span class="line">        File osf &#x3D; new File(osFile);</span><br><span class="line">        if (!osf.exists()) &#123;</span><br><span class="line">            if (!osf.getParentFile().exists()) &#123;</span><br><span class="line">                osf.getParentFile().mkdirs();</span><br><span class="line">            &#125;</span><br><span class="line">            try &#123;</span><br><span class="line">                osf.createNewFile();</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                Logger.Error(&quot;备份文件模块,in copyFile(),判断文件是否创建处尝试创建文件时, Err: IOException&quot;);</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            is &#x3D; new FileInputStream(isFile);</span><br><span class="line">            os &#x3D; new FileOutputStream(osFile);</span><br><span class="line">            byte[] data &#x3D; new byte[1024];&#x2F;&#x2F; 缓存容器</span><br><span class="line">            int len &#x3D; -1;&#x2F;&#x2F; 接收长度</span><br><span class="line">            while ((len &#x3D; is.read(data)) !&#x3D; -1) &#123;</span><br><span class="line">                os.write(data, 0, len);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            Logger.Error(&quot;备份文件模块,in copyFile(), Err: FileNotFoundException&quot;);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            Logger.Error(&quot;备份文件模块,in copyFile(), Err: IOException&quot;);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            &#x2F;&#x2F; 释放资源 分别关闭 先打开的后关闭</span><br><span class="line">            try &#123;</span><br><span class="line">                if (null !&#x3D; os) &#123;</span><br><span class="line">                    os.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                Logger.Error(&quot;备份文件模块,in copyFile(), Err: IOException&quot;);</span><br><span class="line">                e.printStackTrace();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            try &#123;</span><br><span class="line">                if (null !&#x3D; is) &#123;</span><br><span class="line">                    is.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                Logger.Error(&quot;备份文件模块,in copyFile(), Err: IOException&quot;);</span><br><span class="line">                e.printStackTrace();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="信息-Information-java"><a href="#信息-Information-java" class="headerlink" title="信息 Information.java"></a>信息 Information.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">package dingtalkExcel;</span><br><span class="line"></span><br><span class="line">public class Information &#123;</span><br><span class="line"></span><br><span class="line">    private Information() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static final String AppName &#x3D; &quot;钉钉成绩Excel处理&quot;;</span><br><span class="line">    public static final String Version &#x3D; &quot;V3.3.3.7&quot;;&#x2F;&#x2F; 主版本.次版本.发布号.编译次数</span><br><span class="line">    public static final Boolean isBeta &#x3D; false;</span><br><span class="line">    public static final String Author &#x3D; &quot;李坚蔚&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="日志模块-Log-java-1"><a href="#日志模块-Log-java-1" class="headerlink" title="日志模块 Log.java"></a>日志模块 Log.java</h3><figure class="highlight plain"><figcaption><span>dingtalkExcel;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileWriter;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">import javax.swing.JFrame;</span><br><span class="line">import javax.swing.JOptionPane;</span><br><span class="line"></span><br><span class="line">public class Logger &#123;</span><br><span class="line">    private Logger() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public final static File ERRORLOGFILE &#x3D; new File(&quot;.\\Logger\\error.log&quot;);&#x2F;&#x2F; 错误log日志文件默认保存地址</span><br><span class="line">    public final static File LOG &#x3D; new File(&quot;.\\Logger\\ScoreFormat.log&quot;);&#x2F;&#x2F; 操作log日志文件默认保存地址</span><br><span class="line">    private static JFrame parentFrame &#x3D; null;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 用于自定义JOptionPane的父窗口,默认为null</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param parentFrame</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void setParentFrame(JFrame parentFrame) &#123;</span><br><span class="line">        Logger.parentFrame &#x3D; parentFrame;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 这个方法用于提示用户异常信息 &lt;i&gt;Msg&lt;&#x2F;i&gt; 并且储存到文件 &lt;i&gt;logfile&lt;&#x2F;i&gt; 中。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param Msg       错误消息</span><br><span class="line">     * @param errorfile 保存错误日志的文件</span><br><span class="line">     * @param logfile   保存普通日志的文件</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void Error(String Msg, File errorfile, File logfile) &#123;</span><br><span class="line"></span><br><span class="line">        if (!errorfile.getParentFile().exists()) &#123;</span><br><span class="line">            errorfile.getParentFile().mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        if (!errorfile.exists()) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                errorfile.createNewFile();</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; &#x2F;&#x2F; 如果文件没有创建，则创建之</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 输出到error文件中</span><br><span class="line">        FileWriter fw &#x3D; null;</span><br><span class="line">        try &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果文件存在,则追加内容；如果文件不存在,则创建文件</span><br><span class="line">            fw &#x3D; new FileWriter(errorfile, true);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        PrintWriter pw &#x3D; new PrintWriter(fw);</span><br><span class="line">        &#x2F;&#x2F; log文件的内容设计</span><br><span class="line">        String errStr &#x3D; &quot;----[Time:&quot; + new Date().toString() + &quot;] Exception Caused----&quot;</span><br><span class="line">                + System.getProperty(&quot;line.separator&quot;) + &quot;&quot; + Msg + &quot;&quot; + System.getProperty(&quot;line.separator&quot;)</span><br><span class="line">                + &quot;--------------------------------------------------------------------------------&quot;;</span><br><span class="line">        &#x2F;&#x2F; 追加输出</span><br><span class="line">        pw.println(errStr);</span><br><span class="line">        pw.flush();</span><br><span class="line">        pw.close();</span><br><span class="line"></span><br><span class="line">        Log(Msg, logfile);&#x2F;&#x2F; 继续输出到log文件</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 显示人性化提示内容</span><br><span class="line">        String m &#x3D; new String(&quot;不好意思,出现了一个异常。&quot; + System.getProperty(&quot;line.separator&quot;) + &quot;&quot;);</span><br><span class="line">        JOptionPane.showMessageDialog(parentFrame, m + Msg, &quot;错误提示&quot;, JOptionPane.PLAIN_MESSAGE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 这个方法用于提示用户异常信息 &lt;i&gt;Msg&lt;&#x2F;i&gt; 并且储存到默认文件 &lt;i&gt;ERRORLOGFILE&lt;&#x2F;i&gt; 中。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param Msg 错误消息</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void Error(String Msg) &#123;</span><br><span class="line">        Error(Msg, ERRORLOGFILE, LOG);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 这个方法用于储存日志 &lt;i&gt;Msg&lt;&#x2F;i&gt; 到默认文件 &lt;i&gt;LOG&lt;&#x2F;i&gt; 中。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param Msg 日志信息</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void Log(String Msg) &#123;</span><br><span class="line">        Log(Msg, LOG);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 这个方法用于储存日志 &lt;i&gt;Msg&lt;&#x2F;i&gt; 到文件 &lt;i&gt;logfile&lt;&#x2F;i&gt; 中。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param Msg     日志信息</span><br><span class="line">     * @param logfile 保存的文件</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void Log(String Msg, File logfile) &#123;</span><br><span class="line"></span><br><span class="line">        if (!logfile.getParentFile().exists()) &#123;</span><br><span class="line">            logfile.getParentFile().mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        if (!logfile.exists()) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                logfile.createNewFile();</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; &#x2F;&#x2F; 如果文件没有创建，则创建之</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 输出log</span><br><span class="line">        FileWriter fw &#x3D; null;</span><br><span class="line">        try &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果文件存在,则追加内容；如果文件不存在,则创建文件</span><br><span class="line">            fw &#x3D; new FileWriter(logfile, true);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        PrintWriter pw &#x3D; new PrintWriter(fw);</span><br><span class="line">        &#x2F;&#x2F; log文件的内容设计</span><br><span class="line">        String logStr &#x3D; &quot;----[Time:&quot; + new Date().toString() + &quot;] Logger----&quot; + System.getProperty(&quot;line.separator&quot;)</span><br><span class="line">                + &quot;&quot; + Msg + &quot;&quot; + System.getProperty(&quot;line.separator&quot;)</span><br><span class="line">                + &quot;----------------------------------------------------------------------&quot;;</span><br><span class="line">        &#x2F;&#x2F; 追加输出</span><br><span class="line">        pw.println(logStr);</span><br><span class="line">        pw.flush();</span><br><span class="line">        pw.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="读取学生名字和成绩模块-ReadStudentsScores-java-1"><a href="#读取学生名字和成绩模块-ReadStudentsScores-java-1" class="headerlink" title="读取学生名字和成绩模块 ReadStudentsScores.java"></a>读取学生名字和成绩模块 ReadStudentsScores.java</h3><figure class="highlight plain"><figcaption><span>dingtalkExcel;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.math.BigDecimal;</span><br><span class="line">import java.math.RoundingMode;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFCell;</span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFSheet;</span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</span><br><span class="line">import org.apache.poi.ss.usermodel.Cell;</span><br><span class="line">import org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line">import org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line">public class ReadStudentsScores &#123;</span><br><span class="line"></span><br><span class="line">    private ReadStudentsScores() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static Map&lt;Object, Object&gt; StudentsScores &#x3D; new HashMap&lt;Object, Object&gt;();</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * @return the studentsScores</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static Map&lt;Object, Object&gt; getStudentsScores() &#123;</span><br><span class="line">        return StudentsScores;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 根据cell的具体格式,返回特定的字符串。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 如果cell为null,返回空串。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 如果cell类型为boolean、error、numeric,返回其值(String)。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 如果cell类型为formula,返回保留两位的小数(BigDecimal)。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 如果cell类型为string,那么将空格、换行符和制表符去除,返回去除后的字符串(String)。</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param cell 要返回其内容的单元格对象</span><br><span class="line">     * @return 其内容。Object可能是String、Double、Boolean等类型。</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static Object getCellValue(Cell cell) &#123;</span><br><span class="line">        if (cell &#x3D;&#x3D; null) &#123;</span><br><span class="line">            return &quot;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Object obj &#x3D; null;</span><br><span class="line">        switch (cell.getCellType()) &#123;</span><br><span class="line">        case BOOLEAN:</span><br><span class="line">            obj &#x3D; (Boolean) cell.getBooleanCellValue();</span><br><span class="line">            break;</span><br><span class="line">        case ERROR:</span><br><span class="line">            obj &#x3D; cell.getErrorCellValue();</span><br><span class="line">            break;</span><br><span class="line">        case FORMULA:</span><br><span class="line">            try &#123;</span><br><span class="line">                obj &#x3D; String.valueOf(cell.getStringCellValue());</span><br><span class="line">            &#125; catch (IllegalStateException e) &#123;</span><br><span class="line">                String valueOf &#x3D; String.valueOf(cell.getNumericCellValue());</span><br><span class="line">                BigDecimal bd &#x3D; new BigDecimal(Double.valueOf(valueOf));</span><br><span class="line">                bd &#x3D; bd.setScale(2, RoundingMode.HALF_UP);</span><br><span class="line">                obj &#x3D; (Double) bd.doubleValue();</span><br><span class="line">            &#125;</span><br><span class="line">            break;</span><br><span class="line">        case NUMERIC:</span><br><span class="line">            obj &#x3D; cell.getNumericCellValue();</span><br><span class="line">            break;</span><br><span class="line">        case STRING:</span><br><span class="line">            String value &#x3D; String.valueOf(cell.getStringCellValue());</span><br><span class="line">            value &#x3D; value.replace(&quot; &quot;, &quot;&quot;);</span><br><span class="line">            value &#x3D; value.replace(&quot;&quot; + System.getProperty(&quot;line.separator&quot;) + &quot;&quot;, &quot;&quot;);</span><br><span class="line">            value &#x3D; value.replace(&quot;\t&quot;, &quot;&quot;);</span><br><span class="line">            obj &#x3D; value;</span><br><span class="line">            break;</span><br><span class="line">        default:</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">        return obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 读取 &lt;i&gt;excel&lt;&#x2F;i&gt; 文件内的学生名字和成绩,保存在 &lt;i&gt;StudentsScores&lt;&#x2F;i&gt; 这个私有成员中</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param excel      要读取的文件</span><br><span class="line">     * @param sheetindex sheet的下标,从1开始</span><br><span class="line">     * @param scoreindex 成绩保存的列的下标,从1开始</span><br><span class="line">     * @param nameindex  名字保存的列的下标,从1开始</span><br><span class="line">     * @param rowstart   从第几行开始读取数据,从1开始</span><br><span class="line">     * @return 返回StudentsScores</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static Map&lt;Object, Object&gt; readScores(File excel, Integer sheetindex, Integer scoreindex, Integer nameindex,</span><br><span class="line">            Integer rowstart) &#123;</span><br><span class="line">        if (excel.getName().endsWith(&quot;.xlsx&quot;)) &#123;</span><br><span class="line">            return readScoresX(excel, sheetindex, scoreindex, nameindex, rowstart);</span><br><span class="line">        &#125; else if (excel.getName().endsWith(&quot;.xls&quot;)) &#123;</span><br><span class="line">            return readScoresS(excel, sheetindex, scoreindex, nameindex, rowstart);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            Logger.Error(&quot;读取表格时,文件后缀名不匹配!&quot;);</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static Map&lt;Object, Object&gt; readScoresX(File excel, Integer sheetindex, Integer scoreindex,</span><br><span class="line">            Integer nameindex, Integer rowstart) &#123;</span><br><span class="line">        Logger.Log(&quot;调用readScoresX函数。&quot;);</span><br><span class="line">        StudentsScores &#x3D; new HashMap&lt;Object, Object&gt;();</span><br><span class="line"></span><br><span class="line">        if (!excel.exists()) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScoresX(), Err: 导入的文件不存在！&quot;);</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        XSSFWorkbook ecl &#x3D; null;</span><br><span class="line">        try &#123;</span><br><span class="line">            &#x2F;&#x2F; 要处理的表格文件</span><br><span class="line">            Logger.Log(&quot;in ReadStudentsScores.readScoresX(), Note: 尝试打开excel文件[&quot; + excel.getName() + &quot;]。&quot;);</span><br><span class="line">            ecl &#x3D; new XSSFWorkbook(new FileInputStream(excel));</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScoresX(), Err: 尝试打开excel文件FileNotFoundException&quot;);&#x2F;&#x2F; 错误日志</span><br><span class="line">            e.printStackTrace();&#x2F;&#x2F; 屏幕输出</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScoresX(), Err: 尝试打开excel文件IOException&quot;);&#x2F;&#x2F; 错误日志</span><br><span class="line">            e.printStackTrace();&#x2F;&#x2F; 屏幕输出</span><br><span class="line">        &#125;</span><br><span class="line">        if (ecl &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScoresX(), Err: excel文件[&quot; + excel.getName() + &quot;]为空。&quot;);</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 获取指定的sheet</span><br><span class="line">        XSSFSheet sheet &#x3D; ecl.getSheetAt(sheetindex - 1);&#x2F;&#x2F; 真实下标从0开始，所以要减1</span><br><span class="line">        if (sheet &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScoresX(), Err: excel文件中的sheet[&quot; + sheetindex + &quot;]为空。&quot;);</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 获取行数</span><br><span class="line">        Integer lines &#x3D; sheet.getPhysicalNumberOfRows();</span><br><span class="line">        &#x2F;&#x2F; 循环遍历每一行,找到每一行中的姓名和成绩</span><br><span class="line">        for (int i &#x3D; rowstart - 1; i &lt;&#x3D; lines; i++) &#123;</span><br><span class="line">            Logger.Log(&quot;in ReadStudentsScores.readScoresX(), Note: 开始遍历sheet[&quot; + sheetindex + &quot;],line[&quot; + i + &quot;]。&quot;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;            System.out.println(&quot;Debug: Row&#x3D;&quot; + i);&#x2F;&#x2F;Debug_Print</span><br><span class="line"></span><br><span class="line">            if (sheet.getRow(i) &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果为null,不继续循环</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;            System.out.println(&quot;Debug This row is alive.&quot;);&#x2F;&#x2F;Debug_Print</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; 找到每一行的姓名和成绩</span><br><span class="line">            Cell name &#x3D; sheet.getRow(i).getCell(nameindex - 1);&#x2F;&#x2F; 真实下标从0开始，所以要减1</span><br><span class="line">            Cell score &#x3D; sheet.getRow(i).getCell(scoreindex - 1);&#x2F;&#x2F; 真实下标从0开始，所以要减1</span><br><span class="line">            if (name &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果为null,不添加进map</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;            System.out.println(&quot;Debug These cells are alive.&quot;);&#x2F;&#x2F;Debug_Print</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; 将姓名和分数添加到map中</span><br><span class="line"></span><br><span class="line">            if (StudentsScores.containsKey(getCellValue(name))) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果存在重复的名字</span><br><span class="line">                Logger.Error(&quot;in ReadStudentsScores.readScoresX(), Err: 存在重复的名字！&quot;);&#x2F;&#x2F; 错误日志</span><br><span class="line">                return null;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            StudentsScores.put(getCellValue(name), getCellValue(score));&#x2F;&#x2F; 添加名字和他的分数</span><br><span class="line">        &#125;</span><br><span class="line">        return StudentsScores;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static Map&lt;Object, Object&gt; readScoresS(File excel, Integer sheetindex, Integer scoreindex,</span><br><span class="line">            Integer nameindex, Integer rowstart) &#123;</span><br><span class="line">        Logger.Log(&quot;调用readScoresS函数。&quot;);</span><br><span class="line">        StudentsScores &#x3D; new HashMap&lt;Object, Object&gt;();</span><br><span class="line"></span><br><span class="line">        if (!excel.exists()) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScoresS(), Err: 导入的文件不存在！&quot;);</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        HSSFWorkbook ecl &#x3D; null;</span><br><span class="line">        try &#123;</span><br><span class="line">            &#x2F;&#x2F; 要处理的表格文件</span><br><span class="line">            Logger.Log(&quot;in ReadStudentsScores.readScoresS(), Note: 尝试打开excel文件[&quot; + excel.getName() + &quot;]。&quot;);</span><br><span class="line">            ecl &#x3D; new HSSFWorkbook(new FileInputStream(excel));</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScoresS(), Err: 尝试打开excel文件FileNotFoundException&quot;);&#x2F;&#x2F; 错误日志</span><br><span class="line">            e.printStackTrace();&#x2F;&#x2F; 屏幕输出</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScoresS(), Err: 尝试打开excel文件IOException&quot;);&#x2F;&#x2F; 错误日志</span><br><span class="line">            e.printStackTrace();&#x2F;&#x2F; 屏幕输出</span><br><span class="line">        &#125;</span><br><span class="line">        if (ecl &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScoresS(), Err: excel文件[&quot; + excel.getName() + &quot;]为空。&quot;);</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 获取指定的sheet</span><br><span class="line">        HSSFSheet sheet &#x3D; ecl.getSheetAt(sheetindex - 1);&#x2F;&#x2F; 真实下标从0开始，所以要减1</span><br><span class="line">        if (sheet &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in ReadStudentsScores.readScoresS(), Err: excel文件中的sheet[&quot; + sheetindex + &quot;]为空。&quot;);</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 获取行数</span><br><span class="line">        Integer lines &#x3D; sheet.getPhysicalNumberOfRows();</span><br><span class="line">        &#x2F;&#x2F; 循环遍历每一行,找到每一行中的姓名和成绩</span><br><span class="line">        for (int i &#x3D; rowstart - 1; i &lt;&#x3D; lines; i++) &#123;</span><br><span class="line">            Logger.Log(&quot;in ReadStudentsScores.readScoresS(), Note: 开始遍历sheet[&quot; + sheetindex + &quot;],line[&quot; + i + &quot;]。&quot;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;            System.out.println(&quot;Debug: Row&#x3D;&quot; + i);&#x2F;&#x2F;Debug_Print</span><br><span class="line"></span><br><span class="line">            if (sheet.getRow(i) &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果为null,不继续循环</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;            System.out.println(&quot;Debug This row is alive.&quot;);&#x2F;&#x2F;Debug_Print</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; 找到每一行的姓名和成绩</span><br><span class="line">            HSSFCell name &#x3D; sheet.getRow(i).getCell(nameindex - 1);&#x2F;&#x2F; 真实下标从0开始，所以要减1</span><br><span class="line">            HSSFCell score &#x3D; sheet.getRow(i).getCell(scoreindex - 1);&#x2F;&#x2F; 真实下标从0开始，所以要减1</span><br><span class="line">            if (name &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果为null,不添加进map</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;            System.out.println(&quot;Debug These cells are alive.&quot;);&#x2F;&#x2F;Debug_Print</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; 将姓名和分数添加到map中</span><br><span class="line"></span><br><span class="line">            if (StudentsScores.containsKey(getCellValue(name))) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果存在重复的名字</span><br><span class="line">                Logger.Error(&quot;in ReadStudentsScores.readScoresS(), Err: 存在重复的名字！&quot;);&#x2F;&#x2F; 错误日志</span><br><span class="line">                return null;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            StudentsScores.put(getCellValue(name), getCellValue(score));&#x2F;&#x2F; 添加名字和他的分数</span><br><span class="line">        &#125;</span><br><span class="line">        return StudentsScores;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="写入学生成绩模块-WriteStudentsScores-java-1"><a href="#写入学生成绩模块-WriteStudentsScores-java-1" class="headerlink" title="写入学生成绩模块 WriteStudentsScores.java"></a>写入学生成绩模块 WriteStudentsScores.java</h3><figure class="highlight plain"><figcaption><span>dingtalkExcel;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFCell;</span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFSheet;</span><br><span class="line">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</span><br><span class="line">import org.apache.poi.openxml4j.exceptions.InvalidFormatException;</span><br><span class="line">import org.apache.poi.poifs.filesystem.POIFSFileSystem;</span><br><span class="line">import org.apache.poi.xssf.usermodel.XSSFCell;</span><br><span class="line">import org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class="line">import org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line"></span><br><span class="line">public class WriteStudentsScores &#123;</span><br><span class="line"></span><br><span class="line">    private WriteStudentsScores() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 输出 &lt;i&gt;workbook&lt;&#x2F;i&gt; (修改好的excel对象,后缀xls)到指定文件 &lt;i&gt;output&lt;&#x2F;i&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param workbook 修改好的excel对象</span><br><span class="line">     * @param output   输出的文件</span><br><span class="line">     * @return</span><br><span class="line">     *&#x2F;</span><br><span class="line">    private static Boolean writeWorkbookToFile(HSSFWorkbook workbook, File output) &#123;</span><br><span class="line">        Logger.Log(&quot;in WriteStudentsScores.writeWorkbookToFile(), Note: writeWorkbookToFile() start&quot;);</span><br><span class="line">        FileOutputStream outputStream &#x3D; null;</span><br><span class="line">        if (output.isDirectory()) &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果输出文件地址为目录</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeWorkbookToFileS(), Err: 输出文件路径为目录！&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        if (output.exists()) &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果已经存在文件,删掉它,避免不必要的麻烦</span><br><span class="line">            output.delete();</span><br><span class="line">        &#125;</span><br><span class="line">        if (!output.getParentFile().exists()) &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果父目录没有创建,创建父目录</span><br><span class="line">            output.getParentFile().mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        if (!output.exists()) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                output.createNewFile();</span><br><span class="line">                &#x2F;&#x2F; 如果没有创建过文件,当然此处一定没有创建过,因为上面删掉了</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                Logger.Error(&quot;in WriteStudentsScores.writeWorkbookToFileS(), Err: 创建output时的IOException&quot;);</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            Logger.Log(&quot;in WriteStudentsScores.writeWorkbookToFile(), Note: 创建输出的实例&quot;);</span><br><span class="line">            outputStream &#x3D; new FileOutputStream(output);&#x2F;&#x2F; 创建输出的实例</span><br><span class="line">        &#125; catch (FileNotFoundException e1) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeWorkbookToFileS(), Err: 创建outputstream时的FileNotFoundException&quot;);</span><br><span class="line">            e1.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            Logger.Log(&quot;in WriteStudentsScores.writeWorkbookToFile(), Note: 输出workbook(修改好的excel对象)到指定文件&quot;);</span><br><span class="line">            workbook.write(outputStream);&#x2F;&#x2F; 输出workbook(修改好的excel对象)到指定文件</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeWorkbookToFileS(), Err: 输出workbook时的IOException&quot;);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 输出 &lt;i&gt;workbook&lt;&#x2F;i&gt; (修改好的excel对象,后缀xls)到指定文件 &lt;i&gt;output&lt;&#x2F;i&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param workbook 修改好的excel对象</span><br><span class="line">     * @param output   输出的文件</span><br><span class="line">     * @return</span><br><span class="line">     *&#x2F;</span><br><span class="line">    private static Boolean writeWorkbookToFile(XSSFWorkbook workbook, File output) &#123;</span><br><span class="line">        Logger.Log(&quot;in WriteStudentsScores.writeWorkbookToFile(), Note: writeWorkbookToFile() start&quot;);</span><br><span class="line">        FileOutputStream outputStream &#x3D; null;</span><br><span class="line">        if (output.isDirectory()) &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果输出文件地址为目录</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeWorkbookToFileX(), Err: 输出文件路径为目录！&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        if (output.exists()) &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果已经存在文件,删掉它,避免不必要的麻烦</span><br><span class="line">            output.delete();</span><br><span class="line">        &#125;</span><br><span class="line">        if (!output.getParentFile().exists()) &#123;</span><br><span class="line">            &#x2F;&#x2F; 如果父目录没有创建,创建父目录</span><br><span class="line">            output.getParentFile().mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        if (!output.exists()) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                output.createNewFile();</span><br><span class="line">                &#x2F;&#x2F; 如果没有创建过文件,当然此处一定没有创建过,因为上面删掉了</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                Logger.Error(&quot;in WriteStudentsScores.writeWorkbookToFileX(), Err: 创建output时的IOException&quot;);</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            outputStream &#x3D; new FileOutputStream(output);&#x2F;&#x2F; 创建输出的实例</span><br><span class="line">        &#125; catch (FileNotFoundException e1) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeWorkbookToFileX(), Err: 创建outputstream时的FileNotFoundException&quot;);</span><br><span class="line">            e1.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            workbook.write(outputStream);&#x2F;&#x2F; 输出workbook(修改好的excel对象)到指定文件</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeWorkbookToFileX(), Err: 输出workbook时的IOException&quot;);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 从指定文件的指定行读取学生信息后,按照另一个文件的顺序写入成绩</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     * </span><br><span class="line">     * @param mp         储存学生姓名和成绩的map</span><br><span class="line">     * @param outfile    要写入的文件</span><br><span class="line">     * @param sheetindex 要写入文件的sheet的下标,从1开始</span><br><span class="line">     * @param scoreindex 要写入文件的成绩保存的列的下标,从1开始</span><br><span class="line">     * @param nameindex  要写入文件的名字保存的列的下标,从1开始</span><br><span class="line">     * @param rowstart   从第几行开始写入数据,从1开始</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static Boolean writeScores(Map&lt;Object, Object&gt; mp, File outfile, Integer sheetindex, Integer scoreindex,</span><br><span class="line">            Integer nameindex, Integer rowstart) &#123;</span><br><span class="line">        if (outfile.getName().endsWith(&quot;.xlsx&quot;)) &#123;</span><br><span class="line">            return writeScoresX(mp, outfile, sheetindex, scoreindex, nameindex, rowstart);</span><br><span class="line">        &#125; else if (outfile.getName().endsWith(&quot;.xls&quot;)) &#123;</span><br><span class="line">            return writeScoresS(mp, outfile, sheetindex, scoreindex, nameindex, rowstart);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            Logger.Error(&quot;写入表格时,文件后缀名不匹配!&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static Boolean writeScoresX(Map&lt;Object, Object&gt; mp, File outfile, Integer sheetindex, Integer scoreindex,</span><br><span class="line">            Integer nameindex, Integer rowstart) &#123;</span><br><span class="line"></span><br><span class="line">        Logger.Log(&quot;调用writeScores函数。&quot;);</span><br><span class="line">        XSSFWorkbook oxcl &#x3D; null;</span><br><span class="line"></span><br><span class="line">        if (!outfile.exists()) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeScoresX(), Err: 导入的文件不存在！&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        if (mp &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeScoresX(), Err: mp为null！&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            &#x2F;&#x2F; 打开要写入的excel文件</span><br><span class="line">            Logger.Log(&quot;in WriteStudentsScores.writeScoresX(), Note: 尝试打开excel文件[&quot; + outfile.getName() + &quot;]。&quot;);</span><br><span class="line">            oxcl &#x3D; new XSSFWorkbook(outfile);</span><br><span class="line">        &#125; catch (InvalidFormatException e) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeScoresX(), Err: InvalidFormatException&quot;);&#x2F;&#x2F; 错误日志</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            Logger.Error(e.getMessage());</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        if (oxcl &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeScoresX(), Err: 要修改的excel文件[&quot; + outfile.getName() + &quot;]为null！&quot;</span><br><span class="line">                    + System.getProperty(&quot;line.separator&quot;) + &quot;请检查是否存在这个文件！&quot;);&#x2F;&#x2F; 错误日志</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 找到要修改的sheet</span><br><span class="line">        XSSFSheet sheet &#x3D; oxcl.getSheetAt(sheetindex - 1);</span><br><span class="line">        if (sheet &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeScoresX(), Err: excel文件中的sheet[&quot; + sheetindex + &quot;]为空。&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        for (int i &#x3D; rowstart - 1; i &lt;&#x3D; sheet.getPhysicalNumberOfRows(); i++) &#123;</span><br><span class="line">            if (sheet.getRow(i) &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果当前行为null,跳过当前行</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line">            XSSFCell nameCell, scoreCell;</span><br><span class="line">            &#x2F;&#x2F; 从要修改的sheet中找到名字单元格和成绩单元格</span><br><span class="line">            &#x2F;&#x2F; 名字单元格用来查找,,成绩单元格用来写入</span><br><span class="line">            nameCell &#x3D; sheet.getRow(i).getCell(nameindex - 1);</span><br><span class="line">            scoreCell &#x3D; sheet.getRow(i).getCell(scoreindex - 1);</span><br><span class="line">            if (nameCell &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果名字单元格为null,无法继续进行查找并修改</span><br><span class="line">                Logger.Log(&quot;in WriteStudentsScores.writeScoresX(), Note: 名字单元格为null,无法继续进行查找并修改&quot;);</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line">            if (scoreCell &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果要修改的成绩单元格为null,那么我们需要新建一个单元格</span><br><span class="line">                Logger.Log(&quot;in WriteStudentsScores.writeScoresX(), Note: 要修改的成绩单元格为null,那么我们需要新建一个单元格&quot;);</span><br><span class="line">                scoreCell &#x3D; sheet.getRow(i).createCell(scoreindex - 1);</span><br><span class="line">            &#125;</span><br><span class="line">            &#x2F;&#x2F; 寻找mp中是否有这个名字的成绩</span><br><span class="line">            Object scoreObj &#x3D; mp.get(ReadStudentsScores.getCellValue(nameCell));</span><br><span class="line">            if (scoreObj &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果没有,设置这个Obj为(Double)0.0</span><br><span class="line">                Logger.Log(&quot;in WriteStudentsScores.writeScoresX(), Note: mp中没有找到这个学生的名字,设置成绩为(Double)0.0&quot;);</span><br><span class="line">                scoreObj &#x3D; (Double) 0.0;</span><br><span class="line">            &#125;</span><br><span class="line">            if (scoreObj instanceof Double) &#123;&#x2F;&#x2F; 如果是Double类型</span><br><span class="line">                scoreCell.setCellValue((double) scoreObj);&#x2F;&#x2F; 类型转换</span><br><span class="line">            &#125; else if (scoreObj instanceof String) &#123;&#x2F;&#x2F; 如果是String类型</span><br><span class="line">                scoreCell.setCellValue((String) scoreObj);&#x2F;&#x2F; 类型转换</span><br><span class="line">            &#125; else &#123;&#x2F;&#x2F; 如果两种都不是</span><br><span class="line">                Logger.Error(&quot;in WriteStudentsScores.writeScoresX(), Err: 判断scoreObj类型的时候既不是String也不是Double。请联系作者。&quot;);</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Logger.Log(&quot;in WriteStudentsScores.writeScoresX(), Note: 成功修改完表格数据,正在调用writeWorkbookToFile()&quot;);</span><br><span class="line">        return writeWorkbookToFile(oxcl, outfile);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static Boolean writeScoresS(Map&lt;Object, Object&gt; mp, File outfile, Integer sheetindex, Integer scoreindex,</span><br><span class="line">            Integer nameindex, Integer rowstart) &#123;</span><br><span class="line"></span><br><span class="line">        Logger.Log(&quot;调用writeScores函数。&quot;);</span><br><span class="line">        HSSFWorkbook oxcl &#x3D; null;</span><br><span class="line"></span><br><span class="line">        if (!outfile.exists()) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeScoresS(), Err: 导入的文件不存在！&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        if (mp &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeScoresS(), Err: mp为null！&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            &#x2F;&#x2F; 打开要写入的excel文件</span><br><span class="line">            Logger.Log(&quot;in WriteStudentsScores.writeScoresS(), Note: 尝试打开excel文件[&quot; + outfile.getName() + &quot;]。&quot;);</span><br><span class="line">            oxcl &#x3D; new HSSFWorkbook(new POIFSFileSystem(new FileInputStream(outfile)));</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeScoresS(), Err: 打开要写入的excel文件的时候,an IOException raised&quot;);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        if (oxcl &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeScoresS(), Err: 要修改的excel文件[&quot; + outfile.getName() + &quot;]为null！&quot;</span><br><span class="line">                    + System.getProperty(&quot;line.separator&quot;) + &quot;请检查是否存在这个文件！&quot;);&#x2F;&#x2F; 错误日志</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F; 找到要修改的sheet</span><br><span class="line">        HSSFSheet sheet &#x3D; oxcl.getSheetAt(sheetindex - 1);</span><br><span class="line">        if (sheet &#x3D;&#x3D; null) &#123;</span><br><span class="line">            Logger.Error(&quot;in WriteStudentsScores.writeScoresS(), Err: excel文件中的sheet[&quot; + sheetindex + &quot;]为空。&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        for (int i &#x3D; rowstart - 1; i &lt;&#x3D; sheet.getPhysicalNumberOfRows(); i++) &#123;</span><br><span class="line">            if (sheet.getRow(i) &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果当前行为null,跳过当前行</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line">            HSSFCell nameCell;</span><br><span class="line">            HSSFCell scoreCell;</span><br><span class="line">            &#x2F;&#x2F; 从要修改的sheet中找到名字单元格和成绩单元格</span><br><span class="line">            &#x2F;&#x2F; 名字单元格用来查找,成绩单元格用来写入</span><br><span class="line">            nameCell &#x3D; sheet.getRow(i).getCell(nameindex - 1);</span><br><span class="line">            scoreCell &#x3D; sheet.getRow(i).getCell(scoreindex - 1);</span><br><span class="line">            if (nameCell &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果名字单元格为null,无法继续进行查找并修改</span><br><span class="line">                Logger.Log(&quot;in WriteStudentsScores.writeScoresS(), Note: 名字单元格为null,无法继续进行查找并修改&quot;);</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line">            if (scoreCell &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果要修改的成绩单元格为null,那么我们需要新建一个单元格</span><br><span class="line">                Logger.Log(&quot;in WriteStudentsScores.writeScoresS(), Note: 要修改的成绩单元格为null,那么我们需要新建一个单元格&quot;);</span><br><span class="line">                scoreCell &#x3D; sheet.getRow(i).createCell(scoreindex - 1);</span><br><span class="line">            &#125;</span><br><span class="line">            &#x2F;&#x2F; 寻找mp中是否有这个名字的成绩</span><br><span class="line">            Object scoreObj &#x3D; mp.get(ReadStudentsScores.getCellValue(nameCell));</span><br><span class="line">            if (scoreObj &#x3D;&#x3D; null) &#123;</span><br><span class="line">                &#x2F;&#x2F; 如果没有,设置这个Obj为(Double)0.0</span><br><span class="line">                Logger.Log(&quot;in WriteStudentsScores.writeScoresS(), Note: mp中没有找到这个学生的名字,设置成绩为(Double)0.0&quot;);</span><br><span class="line">                scoreObj &#x3D; (Double) 0.0;</span><br><span class="line">            &#125;</span><br><span class="line">            if (scoreObj instanceof Double) &#123;&#x2F;&#x2F; 如果是Double类型</span><br><span class="line">                scoreCell.setCellValue((double) scoreObj);&#x2F;&#x2F; 类型转换</span><br><span class="line">            &#125; else if (scoreObj instanceof String) &#123;&#x2F;&#x2F; 如果是String类型</span><br><span class="line">                scoreCell.setCellValue((String) scoreObj);&#x2F;&#x2F; 类型转换</span><br><span class="line">            &#125; else &#123;&#x2F;&#x2F; 如果两种都不是</span><br><span class="line">                Logger.Error(&quot;in WriteStudentsScores.writeScoresS(), Err: 判断scoreObj类型的时候既不是String也不是Double。请联系作者。&quot;);</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Logger.Log(&quot;in WriteStudentsScores.writeScoresS(), Note: 成功修改完表格数据,正在调用writeWorkbookToFile()&quot;);</span><br><span class="line">        return writeWorkbookToFile(oxcl, outfile);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="主窗体设计-MainFrame-java"><a href="#主窗体设计-MainFrame-java" class="headerlink" title="主窗体设计 MainFrame.java"></a>主窗体设计 MainFrame.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br></pre></td><td class="code"><pre><span class="line">package dingtalkExcel;</span><br><span class="line"></span><br><span class="line">import java.awt.BorderLayout;</span><br><span class="line">import java.awt.Dimension;</span><br><span class="line">import java.awt.Font;</span><br><span class="line">import java.awt.GridLayout;</span><br><span class="line">import java.awt.Toolkit;</span><br><span class="line">import java.awt.datatransfer.StringSelection;</span><br><span class="line">import java.awt.event.ActionEvent;</span><br><span class="line">import java.awt.event.ActionListener;</span><br><span class="line">import java.io.File;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import javax.swing.JButton;</span><br><span class="line">import javax.swing.JFileChooser;</span><br><span class="line">import javax.swing.JFrame;</span><br><span class="line">import javax.swing.JLabel;</span><br><span class="line">import javax.swing.JOptionPane;</span><br><span class="line">import javax.swing.JPanel;</span><br><span class="line">import javax.swing.JTextField;</span><br><span class="line">import javax.swing.UIManager;</span><br><span class="line">import javax.swing.UnsupportedLookAndFeelException;</span><br><span class="line">import javax.swing.filechooser.FileFilter;</span><br><span class="line">import javax.swing.filechooser.FileSystemView;</span><br><span class="line"></span><br><span class="line">import org.apache.poi.openxml4j.exceptions.NotOfficeXmlFileException;</span><br><span class="line"></span><br><span class="line">public class MainFrame extends JFrame implements ActionListener &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * @author 李坚蔚</span><br><span class="line">     *&#x2F;</span><br><span class="line">    private static final long serialVersionUID &#x3D; 8878609498783655729L;</span><br><span class="line"></span><br><span class="line">    private static final Font UIFONT &#x3D; new Font(&quot;宋体&quot;, Font.PLAIN, 12);</span><br><span class="line">    private static final File BackupFileDic &#x3D; new File(&quot;C:\\ExcelBackup-1\\&quot;);</span><br><span class="line"></span><br><span class="line">    private File FileFrom &#x3D; null, FileTo &#x3D; null;</span><br><span class="line"></span><br><span class="line">    private JPanel panel, PN_Title, PN_Body, PN_Bottom, PN_From, PN_To;</span><br><span class="line">    private JPanel PN_FileFrom, PN_FileTo, PN_SheetFrom, PN_SheetTo, PN_NameFrom, PN_NameTo, PN_ScoreFrom, PN_ScoreTo,</span><br><span class="line">            PN_LineFrom, PN_LineTo;</span><br><span class="line">    private JLabel LB_Title, LB_Version;</span><br><span class="line">    private JLabel LB_FileFrom, LB_FileTo, LB_SheetFrom, LB_SheetTo, LB_NameFrom, LB_NameTo, LB_ScoreFrom, LB_ScoreTo,</span><br><span class="line">            LB_LineFrom, LB_LineTo;</span><br><span class="line">    private JButton BT_Helper, BT_FileChooserFrom, BT_FileChooserTo, BT_Confirm, BT_Cancel;</span><br><span class="line">    private JTextField TF_FileFrom, TF_FileTo, TF_SheetFrom, TF_SheetTo, TF_NameFrom, TF_NameTo, TF_ScoreFrom,</span><br><span class="line">            TF_ScoreTo, TF_LineFrom, TF_LineTo;</span><br><span class="line"></span><br><span class="line">    private JPanel getBodyPanel() &#123;</span><br><span class="line">        JPanel jp &#x3D; new JPanel(new GridLayout(2, 1));</span><br><span class="line"></span><br><span class="line">        PN_From &#x3D; new JPanel(new GridLayout(1, 5));</span><br><span class="line">        PN_To &#x3D; new JPanel(new GridLayout(1, 5));</span><br><span class="line"></span><br><span class="line">        PN_FileFrom &#x3D; new JPanel(new GridLayout(1, 3));</span><br><span class="line">        PN_FileTo &#x3D; new JPanel(new GridLayout(1, 3));</span><br><span class="line">        PN_SheetFrom &#x3D; new JPanel(new GridLayout(1, 2));</span><br><span class="line">        PN_SheetTo &#x3D; new JPanel(new GridLayout(1, 2));</span><br><span class="line">        PN_NameFrom &#x3D; new JPanel(new GridLayout(1, 2));</span><br><span class="line">        PN_NameTo &#x3D; new JPanel(new GridLayout(1, 2));</span><br><span class="line">        PN_ScoreFrom &#x3D; new JPanel(new GridLayout(1, 2));</span><br><span class="line">        PN_ScoreTo &#x3D; new JPanel(new GridLayout(1, 2));</span><br><span class="line">        PN_LineFrom &#x3D; new JPanel(new GridLayout(1, 2));</span><br><span class="line">        PN_LineTo &#x3D; new JPanel(new GridLayout(1, 2));</span><br><span class="line"></span><br><span class="line">        PN_From.add(PN_FileFrom);</span><br><span class="line">        PN_From.add(PN_SheetFrom);</span><br><span class="line">        PN_From.add(PN_NameFrom);</span><br><span class="line">        PN_From.add(PN_ScoreFrom);</span><br><span class="line">        PN_From.add(PN_LineFrom);</span><br><span class="line"></span><br><span class="line">        PN_To.add(PN_FileTo);</span><br><span class="line">        PN_To.add(PN_SheetTo);</span><br><span class="line">        PN_To.add(PN_NameTo);</span><br><span class="line">        PN_To.add(PN_ScoreTo);</span><br><span class="line">        PN_To.add(PN_LineTo);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; FileFrom</span><br><span class="line">        LB_FileFrom &#x3D; new JLabel(&quot;文件来源:&quot;);</span><br><span class="line">        LB_FileFrom.setFont(UIFONT);</span><br><span class="line">        TF_FileFrom &#x3D; new JTextField();</span><br><span class="line">        TF_FileFrom.setEditable(false);</span><br><span class="line">        TF_FileFrom.setFont(UIFONT);</span><br><span class="line">        BT_FileChooserFrom &#x3D; new JButton(&quot;选择&quot;);</span><br><span class="line">        BT_FileChooserFrom.setFont(UIFONT);</span><br><span class="line">        BT_FileChooserFrom.addActionListener(this);</span><br><span class="line">        PN_FileFrom.add(LB_FileFrom);</span><br><span class="line">        PN_FileFrom.add(TF_FileFrom);</span><br><span class="line">        PN_FileFrom.add(BT_FileChooserFrom);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; FileTo</span><br><span class="line">        LB_FileTo &#x3D; new JLabel(&quot;文件导出:&quot;);</span><br><span class="line">        LB_FileTo.setFont(UIFONT);</span><br><span class="line">        TF_FileTo &#x3D; new JTextField();</span><br><span class="line">        TF_FileTo.setEditable(false);</span><br><span class="line">        TF_FileTo.setFont(UIFONT);</span><br><span class="line">        BT_FileChooserTo &#x3D; new JButton(&quot;选择&quot;);</span><br><span class="line">        BT_FileChooserTo.setFont(UIFONT);</span><br><span class="line">        BT_FileChooserTo.addActionListener(this);</span><br><span class="line">        PN_FileTo.add(LB_FileTo);</span><br><span class="line">        PN_FileTo.add(TF_FileTo);</span><br><span class="line">        PN_FileTo.add(BT_FileChooserTo);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; SheetFrom</span><br><span class="line">        LB_SheetFrom &#x3D; new JLabel(&quot;导入表序号:&quot;);</span><br><span class="line">        LB_SheetFrom.setFont(UIFONT);</span><br><span class="line">        TF_SheetFrom &#x3D; new JTextField();</span><br><span class="line">        TF_SheetFrom.setFont(UIFONT);</span><br><span class="line">        PN_SheetFrom.add(LB_SheetFrom);</span><br><span class="line">        PN_SheetFrom.add(TF_SheetFrom);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; SheetTo</span><br><span class="line">        LB_SheetTo &#x3D; new JLabel(&quot;导出表序号:&quot;);</span><br><span class="line">        LB_SheetTo.setFont(UIFONT);</span><br><span class="line">        TF_SheetTo &#x3D; new JTextField();</span><br><span class="line">        TF_SheetTo.setFont(UIFONT);</span><br><span class="line">        PN_SheetTo.add(LB_SheetTo);</span><br><span class="line">        PN_SheetTo.add(TF_SheetTo);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; NameFrom</span><br><span class="line">        LB_NameFrom &#x3D; new JLabel(&quot;导入名字列数:&quot;);</span><br><span class="line">        LB_NameFrom.setFont(UIFONT);</span><br><span class="line">        TF_NameFrom &#x3D; new JTextField();</span><br><span class="line">        TF_NameFrom.setFont(UIFONT);</span><br><span class="line">        PN_NameFrom.add(LB_NameFrom);</span><br><span class="line">        PN_NameFrom.add(TF_NameFrom);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; NameTo</span><br><span class="line">        LB_NameTo &#x3D; new JLabel(&quot;导出名字列数:&quot;);</span><br><span class="line">        LB_NameTo.setFont(UIFONT);</span><br><span class="line">        TF_NameTo &#x3D; new JTextField();</span><br><span class="line">        TF_NameTo.setFont(UIFONT);</span><br><span class="line">        PN_NameTo.add(LB_NameTo);</span><br><span class="line">        PN_NameTo.add(TF_NameTo);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; ScoreFrom</span><br><span class="line">        LB_ScoreFrom &#x3D; new JLabel(&quot;导入成绩列数:&quot;);</span><br><span class="line">        LB_ScoreFrom.setFont(UIFONT);</span><br><span class="line">        TF_ScoreFrom &#x3D; new JTextField();</span><br><span class="line">        TF_ScoreFrom.setFont(UIFONT);</span><br><span class="line">        PN_ScoreFrom.add(LB_ScoreFrom);</span><br><span class="line">        PN_ScoreFrom.add(TF_ScoreFrom);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; ScoreTo</span><br><span class="line">        LB_ScoreTo &#x3D; new JLabel(&quot;导出成绩列数:&quot;);</span><br><span class="line">        LB_ScoreTo.setFont(UIFONT);</span><br><span class="line">        TF_ScoreTo &#x3D; new JTextField();</span><br><span class="line">        TF_ScoreTo.setFont(UIFONT);</span><br><span class="line">        PN_ScoreTo.add(LB_ScoreTo);</span><br><span class="line">        PN_ScoreTo.add(TF_ScoreTo);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; LineFrom</span><br><span class="line">        LB_LineFrom &#x3D; new JLabel(&quot;导入起始行数:&quot;);</span><br><span class="line">        LB_LineFrom.setFont(UIFONT);</span><br><span class="line">        TF_LineFrom &#x3D; new JTextField();</span><br><span class="line">        TF_LineFrom.setFont(UIFONT);</span><br><span class="line">        PN_LineFrom.add(LB_LineFrom);</span><br><span class="line">        PN_LineFrom.add(TF_LineFrom);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; LineTo</span><br><span class="line">        LB_LineTo &#x3D; new JLabel(&quot;导出起始行数:&quot;);</span><br><span class="line">        LB_LineTo.setFont(UIFONT);</span><br><span class="line">        TF_LineTo &#x3D; new JTextField();</span><br><span class="line">        TF_LineTo.setFont(UIFONT);</span><br><span class="line">        PN_LineTo.add(LB_LineTo);</span><br><span class="line">        PN_LineTo.add(TF_LineTo);</span><br><span class="line"></span><br><span class="line">        jp.add(PN_From);</span><br><span class="line">        jp.add(PN_To);</span><br><span class="line"></span><br><span class="line">        return jp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public MainFrame() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());</span><br><span class="line">        &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">            Logger.Error(&quot;Err: After UIManager.setLookAndFeel, ClassNotFoundException&quot;);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (InstantiationException e) &#123;</span><br><span class="line">            Logger.Error(&quot;Err: After UIManager.setLookAndFeel, InstantiationException&quot;);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IllegalAccessException e) &#123;</span><br><span class="line">            Logger.Error(&quot;Err: After UIManager.setLookAndFeel, IllegalAccessException&quot;);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (UnsupportedLookAndFeelException e) &#123;</span><br><span class="line">            Logger.Error(&quot;Err: After UIManager.setLookAndFeel, UnsupportedLookAndFeelException&quot;);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; TODO 希望增加弹窗输入行数、工作表序号等等信息,而不是拖沓在主程序</span><br><span class="line"></span><br><span class="line">        this.setTitle(Information.AppName);&#x2F;&#x2F; 设置程序标题</span><br><span class="line">        this.setDefaultCloseOperation(EXIT_ON_CLOSE);&#x2F;&#x2F; 设置关闭窗口的方式:结束程序</span><br><span class="line">        this.setSize(900, 180);&#x2F;&#x2F; 设置窗体的大小,TODO 有待调试</span><br><span class="line">        this.setMinimumSize(new Dimension(900, 180));&#x2F;&#x2F; 设置窗体最小的大小,防止某些组件看不到,TODO 有待调试</span><br><span class="line">        this.setLocationRelativeTo(null);&#x2F;&#x2F; 移动窗口到屏幕中央</span><br><span class="line"></span><br><span class="line">        panel &#x3D; new JPanel();&#x2F;&#x2F; 创建panel对象</span><br><span class="line">        panel.setLayout(new BorderLayout());&#x2F;&#x2F; 采用边界布局方式</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 最上方的一些面板</span><br><span class="line">        PN_Title &#x3D; new JPanel(new GridLayout(1, 3));&#x2F;&#x2F; 最上面一栏的显示,放置主程序名字(标题)、版本号和帮助按钮</span><br><span class="line">        LB_Title &#x3D; new JLabel(Information.AppName);&#x2F;&#x2F; 标题文字,初始化文字为主程序名字</span><br><span class="line">        LB_Version &#x3D; new JLabel(Information.Version);&#x2F;&#x2F; 版本号文字,初始化为版本号</span><br><span class="line">        BT_Helper &#x3D; new JButton(&quot;帮助&quot;);&#x2F;&#x2F; 帮助按钮,用于显示帮助文字</span><br><span class="line">        LB_Title.setFont(UIFONT);&#x2F;&#x2F; 设置字体</span><br><span class="line">        LB_Version.setFont(UIFONT);&#x2F;&#x2F; 设置字体</span><br><span class="line">        BT_Helper.setFont(UIFONT);&#x2F;&#x2F; 设置字体</span><br><span class="line">        BT_Helper.addActionListener(this);</span><br><span class="line">        PN_Title.add(LB_Title);&#x2F;&#x2F; 添加组件到面板</span><br><span class="line">        PN_Title.add(LB_Version);&#x2F;&#x2F; 添加组件到面板</span><br><span class="line">        PN_Title.add(BT_Helper);&#x2F;&#x2F; 添加组件到面板</span><br><span class="line">        panel.add(&quot;North&quot;, PN_Title);&#x2F;&#x2F; 将整个最上方的面板添加到NORTH</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 中间的一些面板</span><br><span class="line">        PN_Body &#x3D; getBodyPanel();</span><br><span class="line">        panel.add(&quot;Center&quot;, PN_Body);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; 最下面的面板</span><br><span class="line">        PN_Bottom &#x3D; new JPanel(new GridLayout(1, 2));</span><br><span class="line">        BT_Confirm &#x3D; new JButton(&quot;导出&quot;);</span><br><span class="line">        BT_Confirm.setFont(UIFONT);</span><br><span class="line">        BT_Confirm.addActionListener(this);</span><br><span class="line">        BT_Cancel &#x3D; new JButton(&quot;清除所有&quot;);</span><br><span class="line">        BT_Cancel.setFont(UIFONT);</span><br><span class="line">        BT_Cancel.addActionListener(this);</span><br><span class="line">        PN_Bottom.add(BT_Confirm);</span><br><span class="line">        PN_Bottom.add(BT_Cancel);</span><br><span class="line">        panel.add(&quot;South&quot;, PN_Bottom);</span><br><span class="line"></span><br><span class="line">        this.setContentPane(panel);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void actionPerformed(ActionEvent e) &#123;</span><br><span class="line">        if (e.getSource() &#x3D;&#x3D; BT_Helper) &#123;</span><br><span class="line">            String HelpWords &#x3D; new String(&quot;帮助:&quot; + System.getProperty(&quot;line.separator&quot;) + &quot;&quot;</span><br><span class="line">                    + &quot;先选择成绩来源的excel表格(xlsx,xls)文件,&quot; + System.getProperty(&quot;line.separator&quot;) + &quot;&quot;</span><br><span class="line">                    + &quot;再选择要导出成绩的excel表格(xlsx,xls)文件,&quot; + System.getProperty(&quot;line.separator&quot;) + &quot;&quot;</span><br><span class="line">                    + &quot;然后输入两个表格分别的工作表序号、姓名列数和开始读取数据的行数,&quot; + System.getProperty(&quot;line.separator&quot;) + &quot;&quot;</span><br><span class="line">                    + &quot;确认无误后点击“开始”按钮,等待提示信息出现后,查看导出成绩的excel表格中是不是成功导出成绩!&quot; + System.getProperty(&quot;line.separator&quot;) + &quot;&quot;</span><br><span class="line">                    + &quot;&quot; + System.getProperty(&quot;line.separator&quot;) + &quot;&quot; + &quot;感谢使用!作者:&quot; + Information.Author);</span><br><span class="line">            JOptionPane.showMessageDialog(this, HelpWords);</span><br><span class="line">        &#125; else if (e.getSource() &#x3D;&#x3D; BT_FileChooserFrom) &#123;</span><br><span class="line">            int result &#x3D; 0;</span><br><span class="line">            File file &#x3D; null;</span><br><span class="line">            JFileChooser fileChooser &#x3D; new JFileChooser();</span><br><span class="line">            FileSystemView fsv &#x3D; FileSystemView.getFileSystemView();</span><br><span class="line">            Logger.Log(&quot;in MainFrame.java, actionPerformed() Note: 获得桌面路径&quot; + fsv.getHomeDirectory());</span><br><span class="line">            fileChooser.setCurrentDirectory(fsv.getHomeDirectory());</span><br><span class="line">            fileChooser.setDialogTitle(&quot;请选择表格来源...&quot;);</span><br><span class="line">            fileChooser.setApproveButtonText(&quot;确定&quot;);</span><br><span class="line">            fileChooser.setFileFilter(new FileFilter() &#123;</span><br><span class="line">                public boolean accept(File f) &#123; &#x2F;&#x2F; 设定可用的文件的后缀名</span><br><span class="line">                    if (f.getName().endsWith(&quot;.xlsx&quot;) || f.isDirectory() || f.getName().endsWith(&quot;.xls&quot;)) &#123;</span><br><span class="line">                        return true;</span><br><span class="line">                    &#125;</span><br><span class="line">                    return false;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                public String getDescription() &#123;</span><br><span class="line">                    return &quot;EXCEL 工作表(*.xlsx,*.xls)&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            result &#x3D; fileChooser.showOpenDialog(this);</span><br><span class="line">            if (JFileChooser.APPROVE_OPTION &#x3D;&#x3D; result) &#123;</span><br><span class="line">                &#x2F;&#x2F; 更改textfield内容,更改选择的文件来源</span><br><span class="line">                file &#x3D; fileChooser.getSelectedFile();</span><br><span class="line">                if (!(file &#x3D;&#x3D; null)) &#123;</span><br><span class="line">                    TF_FileFrom.setText(file.getName());</span><br><span class="line">                    FileFrom &#x3D; file;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">&#x2F;&#x2F;                JOptionPane.showMessageDialog(this, &quot;用户取消了选择。&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (e.getSource() &#x3D;&#x3D; BT_FileChooserTo) &#123;</span><br><span class="line">            int result &#x3D; 0;</span><br><span class="line">            File file &#x3D; null;</span><br><span class="line">            JFileChooser fileChooser &#x3D; new JFileChooser();</span><br><span class="line">            FileSystemView fsv &#x3D; FileSystemView.getFileSystemView();</span><br><span class="line">            Logger.Log(&quot;in MainFrame.java, actionPerformed() Note: 获得桌面路径&quot; + fsv.getHomeDirectory());</span><br><span class="line">            fileChooser.setCurrentDirectory(fsv.getHomeDirectory());</span><br><span class="line">            fileChooser.setDialogTitle(&quot;请选择导出的表格...&quot;);</span><br><span class="line">            fileChooser.setApproveButtonText(&quot;确定&quot;);</span><br><span class="line">            fileChooser.setFileFilter(new FileFilter() &#123;</span><br><span class="line">                public boolean accept(File f) &#123; &#x2F;&#x2F; 设定可用的文件的后缀名</span><br><span class="line">                    if (f.getName().endsWith(&quot;.xlsx&quot;) || f.isDirectory() || f.getName().endsWith(&quot;.xls&quot;)) &#123;</span><br><span class="line">                        return true;</span><br><span class="line">                    &#125;</span><br><span class="line">                    return false;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                public String getDescription() &#123;</span><br><span class="line">                    return &quot;EXCEL 工作表(*.xlsx,*.xls)&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            result &#x3D; fileChooser.showOpenDialog(this);</span><br><span class="line">            if (JFileChooser.APPROVE_OPTION &#x3D;&#x3D; result) &#123;</span><br><span class="line">                &#x2F;&#x2F; 更改textfield内容,更改选择的文件来源</span><br><span class="line">                file &#x3D; fileChooser.getSelectedFile();</span><br><span class="line">                if (!(file &#x3D;&#x3D; null)) &#123;</span><br><span class="line">                    TF_FileTo.setText(file.getName());</span><br><span class="line">                    FileTo &#x3D; file;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">&#x2F;&#x2F;                JOptionPane.showMessageDialog(this, &quot;用户取消了选择。&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (e.getSource() &#x3D;&#x3D; BT_Confirm) &#123;</span><br><span class="line">            Logger.Log(&quot;in MainFrame.java, Note: 确认按钮(BT_Confirm)按下&quot;);</span><br><span class="line"></span><br><span class="line">            FileCopyUtils.copyFile(FileFrom.getAbsolutePath(),</span><br><span class="line">                    BackupFileDic.getAbsolutePath() + &quot;\\&quot; + (System.currentTimeMillis() + &quot;-&quot; + FileFrom.getName()));&#x2F;&#x2F; 备份文件,前面加上时间戳</span><br><span class="line">            FileCopyUtils.copyFile(FileTo.getAbsolutePath(),</span><br><span class="line">                    BackupFileDic.getAbsolutePath() + &quot;\\&quot; + (System.currentTimeMillis() + &quot;-&quot; + FileTo.getName()));&#x2F;&#x2F; 备份文件,前面加上时间戳</span><br><span class="line">            Toolkit.getDefaultToolkit().getSystemClipboard()</span><br><span class="line">                    .setContents(new StringSelection(BackupFileDic.getAbsolutePath()), null);</span><br><span class="line">            JOptionPane.showMessageDialog(this, &quot;正在导出...如果需要备份文件,那么备份文件位置在&quot; + BackupFileDic.getAbsolutePath() + &quot;&quot;</span><br><span class="line">                    + System.getProperty(&quot;line.separator&quot;) + &quot;路径已经复制到剪贴板。&quot;, &quot;提示&quot;, JOptionPane.PLAIN_MESSAGE);</span><br><span class="line">            try &#123;</span><br><span class="line">                Map&lt;Object, Object&gt; mp &#x3D; ReadStudentsScores.readScores(FileFrom,</span><br><span class="line">                        Integer.valueOf(TF_SheetFrom.getText()), Integer.valueOf(TF_ScoreFrom.getText()),</span><br><span class="line">                        Integer.valueOf(TF_NameFrom.getText()), Integer.valueOf(TF_LineFrom.getText()));</span><br><span class="line">                Boolean f1 &#x3D; WriteStudentsScores.writeScores(mp, FileTo, Integer.valueOf(TF_SheetTo.getText()),</span><br><span class="line">                        Integer.valueOf(TF_ScoreTo.getText()), Integer.valueOf(TF_NameTo.getText()),</span><br><span class="line">                        Integer.valueOf(TF_LineTo.getText()));</span><br><span class="line">                if (mp !&#x3D; null &amp;&amp; f1) &#123;</span><br><span class="line">                    JOptionPane.showMessageDialog(this, &quot;导出成功!&quot;, &quot;提示&quot;, JOptionPane.PLAIN_MESSAGE);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (NotOfficeXmlFileException e1) &#123;</span><br><span class="line">                Logger.Error(&quot;No valid entries or contents found, this is not a valid OOXML (Office Open XML) file&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (e.getSource() &#x3D;&#x3D; BT_Cancel) &#123;</span><br><span class="line">            FileFrom &#x3D; null;</span><br><span class="line">            FileTo &#x3D; null;</span><br><span class="line">            TF_FileFrom.setText(&quot;&quot;);</span><br><span class="line">            TF_FileTo.setText(&quot;&quot;);</span><br><span class="line">            TF_LineFrom.setText(&quot;&quot;);</span><br><span class="line">            TF_LineTo.setText(&quot;&quot;);</span><br><span class="line">            TF_NameFrom.setText(&quot;&quot;);</span><br><span class="line">            TF_NameTo.setText(&quot;&quot;);</span><br><span class="line">            TF_ScoreFrom.setText(&quot;&quot;);</span><br><span class="line">            TF_ScoreTo.setText(&quot;&quot;);</span><br><span class="line">            TF_SheetFrom.setText(&quot;&quot;);</span><br><span class="line">            TF_SheetTo.setText(&quot;&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            Logger.Error(&quot;in MainFrame.java, actionPerformed() Err: 未知来源的ActionEvent e&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="入口程序-Start-java-1"><a href="#入口程序-Start-java-1" class="headerlink" title="入口程序 Start.java"></a>入口程序 Start.java</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">package dingtalkExcel;</span><br><span class="line"></span><br><span class="line">public class Start &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        Logger.Log(&quot;主程序开始。&quot;);</span><br><span class="line"></span><br><span class="line">        new MainFrame().setVisible(true);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag"># 编程</a>
              <a href="/tags/%E7%94%B5%E8%84%91%E5%B7%A5%E5%85%B7/" rel="tag"># 电脑工具</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/10/19/%E5%AD%A6%E7%A7%91/%E6%95%B0%E5%AD%A6%E8%87%AA%E7%BC%96%E9%A2%98-2020-10/" rel="prev" title="数学自编题-2020.10">
      <i class="fa fa-chevron-left"></i> 数学自编题-2020.10
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/12/06/%E5%86%99%E4%BD%9C/%E6%B8%94%E5%AE%B6%E5%82%B2%C2%B7%E7%A7%8B%E6%80%9D%E3%80%90%E8%8C%83%E4%BB%B2%E6%B7%B9%E3%80%91-%E6%94%B9%E5%86%99/" rel="next" title="渔家傲·秋思【范仲淹】-改写">
      渔家傲·秋思【范仲淹】-改写 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%92%89%E9%92%89excel%E6%88%90%E7%BB%A9%E4%B8%8A%E4%BC%A0%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B7%A5%E5%85%B7"><span class="nav-number">1.</span> <span class="nav-text">钉钉excel成绩上传格式化工具</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Version-1-0-Beta-Date-2020-11-07-16-30"><span class="nav-number">1.1.</span> <span class="nav-text">Version 1.0-Beta Date:2020.11.07 16:30</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="nav-number">1.1.1.</span> <span class="nav-text">准备工作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97-Log-java"><span class="nav-number">1.1.2.</span> <span class="nav-text">日志模块 Log.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96%E5%AD%A6%E7%94%9F%E5%90%8D%E5%AD%97%E5%92%8C%E6%88%90%E7%BB%A9%E6%A8%A1%E5%9D%97-ReadStudentsScores-java"><span class="nav-number">1.1.3.</span> <span class="nav-text">读取学生名字和成绩模块 ReadStudentsScores.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%99%E5%85%A5%E5%AD%A6%E7%94%9F%E6%88%90%E7%BB%A9%E6%A8%A1%E5%9D%97-WriteStudentsScores-java"><span class="nav-number">1.1.4.</span> <span class="nav-text">写入学生成绩模块 WriteStudentsScores.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A5%E5%8F%A3%E7%A8%8B%E5%BA%8F-Start-java"><span class="nav-number">1.1.5.</span> <span class="nav-text">入口程序 Start.java</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Version-3-3-Date-2020-12-07-21-50"><span class="nav-number">1.2.</span> <span class="nav-text">Version 3.3 Date:2020.12.07 21:50</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%A4%8D%E5%88%B6%E6%A8%A1%E5%9D%97-FileCopyUtils-java"><span class="nav-number">1.2.1.</span> <span class="nav-text">文件复制模块 FileCopyUtils.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%A1%E6%81%AF-Information-java"><span class="nav-number">1.2.2.</span> <span class="nav-text">信息 Information.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97-Log-java-1"><span class="nav-number">1.2.3.</span> <span class="nav-text">日志模块 Log.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96%E5%AD%A6%E7%94%9F%E5%90%8D%E5%AD%97%E5%92%8C%E6%88%90%E7%BB%A9%E6%A8%A1%E5%9D%97-ReadStudentsScores-java-1"><span class="nav-number">1.2.4.</span> <span class="nav-text">读取学生名字和成绩模块 ReadStudentsScores.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%99%E5%85%A5%E5%AD%A6%E7%94%9F%E6%88%90%E7%BB%A9%E6%A8%A1%E5%9D%97-WriteStudentsScores-java-1"><span class="nav-number">1.2.5.</span> <span class="nav-text">写入学生成绩模块 WriteStudentsScores.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E7%AA%97%E4%BD%93%E8%AE%BE%E8%AE%A1-MainFrame-java"><span class="nav-number">1.2.6.</span> <span class="nav-text">主窗体设计 MainFrame.java</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A5%E5%8F%A3%E7%A8%8B%E5%BA%8F-Start-java-1"><span class="nav-number">1.2.7.</span> <span class="nav-text">入口程序 Start.java</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="李坚蔚"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">李坚蔚</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">15</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:tel13958391458@qq.com" title="E-Mail → mailto:tel13958391458@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://101.132.149.99/" title="http:&#x2F;&#x2F;101.132.149.99" rel="noopener" target="_blank">my OJ</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李坚蔚</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
